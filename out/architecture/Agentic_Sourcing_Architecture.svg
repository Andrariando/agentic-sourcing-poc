<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="3137px" preserveAspectRatio="none" style="width:3626px;height:3137px;background:#FEFEFE;" version="1.1" viewBox="0 0 3626 3137" width="3626px" zoomAndPan="magnify"><defs><filter height="300%" id="f5hde0k0kr1te" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="240" x="1686.5" y="11.4189">Agentic Sourcing Copilot - Enterprise Architecture</text><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacing" textLength="281" x="1666" y="25.2549">Human-in-the-Loop Multi-Agent Decision Support System</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="0" x="1808" y="39.0908"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="133" x="1631.5" y="52.9268">Current Implementation</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="214" x="1767.5" y="52.9268">— LLM-First Classification &amp; Artifact System</text><!--MD5=[4c275c90aa705310e0149fa934b9dd18]
cluster **FRONTEND** - Streamlit UI--><path d="M11,380.3438 L135,380.3438 A7.5,7.5 0 0 1 140,385.3438 L147,400.1797 L503,400.1797 A5,5 0 0 1 508,405.1797 L508,741.8438 A5,5 0 0 1 503,746.8438 L11,746.8438 A5,5 0 0 1 6,741.8438 L6,385.3438 A5,5 0 0 1 11,380.3438 " fill="#FEFEFE" filter="url(#f5hde0k0kr1te)" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="6" x2="147" y1="400.1797" y2="400.1797"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="55" x="10" y="393.7627">FRONTEND</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="70" x="68" y="393.7627">- Streamlit UI</text><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacing" textLength="52" x="235" y="413.5986">«frontend»</text><!--MD5=[9ac15a0cf91036a266899d8638101d30]
cluster **BACKEND** - FastAPI Server--><path d="M537,548.3438 L674,548.3438 A7.5,7.5 0 0 1 679,553.3438 L686,568.1797 L2571,568.1797 A5,5 0 0 1 2576,573.1797 L2576,2251.8438 A5,5 0 0 1 2571,2256.8438 L537,2256.8438 A5,5 0 0 1 532,2251.8438 L532,553.3438 A5,5 0 0 1 537,548.3438 " fill="#FEFEFE" filter="url(#f5hde0k0kr1te)" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="532" x2="686" y1="568.1797" y2="568.1797"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="50" x="536" y="561.7627">BACKEND</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="88" x="589" y="561.7627">- FastAPI Server</text><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacing" textLength="55" x="1530.5" y="581.5986">«backend»</text><!--MD5=[8c6f3eb1e022e81ddcb8dd81e44e8cb0]
cluster **Services Layer**--><path d="M1907,1057.3438 L1985,1057.3438 A7.5,7.5 0 0 1 1990,1062.3438 L1997,1077.1797 L2228,1077.1797 A5,5 0 0 1 2233,1082.1797 L2233,1668.8438 A5,5 0 0 1 2228,1673.8438 L1907,1673.8438 A5,5 0 0 1 1902,1668.8438 L1902,1062.3438 A5,5 0 0 1 1907,1057.3438 " fill="#FEFEFE" filter="url(#f5hde0k0kr1te)" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="1902" x2="1997" y1="1077.1797" y2="1077.1797"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="82" x="1906" y="1070.7627">Services Layer</text><!--MD5=[3de3d5543dc291a4255e037d5ae25fa2]
cluster **SUPERVISOR** - Central Orchestrator--><path d="M1972,602.3438 L2159,602.3438 A7.5,7.5 0 0 1 2164,607.3438 L2171,622.1797 L2267,622.1797 A5,5 0 0 1 2272,627.1797 L2272,965.3438 A5,5 0 0 1 2267,970.3438 L1972,970.3438 A5,5 0 0 1 1967,965.3438 L1967,607.3438 A5,5 0 0 1 1972,602.3438 " fill="#FEFEFE" filter="url(#f5hde0k0kr1te)" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="1967" x2="2171" y1="622.1797" y2="622.1797"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="67" x="1971" y="615.7627">SUPERVISOR</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="121" x="2041" y="615.7627">- Central Orchestrator</text><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacing" textLength="64" x="2091.5" y="635.5986">«supervisor»</text><!--MD5=[1a199e9c8f2ac4c206e7c8e7db9c8715]
cluster **7 OFFICIAL AGENTS**--><path d="M771,1267.3438 L871,1267.3438 A7.5,7.5 0 0 1 876,1272.3438 L883,1287.1797 L1834,1287.1797 A5,5 0 0 1 1839,1292.1797 L1839,1477.3438 A5,5 0 0 1 1834,1482.3438 L771,1482.3438 A5,5 0 0 1 766,1477.3438 L766,1272.3438 A5,5 0 0 1 771,1267.3438 " fill="#FEFEFE" filter="url(#f5hde0k0kr1te)" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="766" x2="883" y1="1287.1797" y2="1287.1797"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="104" x="770" y="1280.7627">7 OFFICIAL AGENTS</text><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacing" textLength="39" x="1287" y="1300.5986">«agent»</text><!--MD5=[4fc4e5993e795f06bb4192b1b07c81cf]
cluster **TASK EXECUTION LAYER**--><path d="M1721,1543.3438 L1846,1543.3438 A7.5,7.5 0 0 1 1851,1548.3438 L1858,1563.1797 L1873,1563.1797 A5,5 0 0 1 1878,1568.1797 L1878,2227.8438 A5,5 0 0 1 1873,2232.8438 L1721,2232.8438 A5,5 0 0 1 1716,2227.8438 L1716,1548.3438 A5,5 0 0 1 1721,1543.3438 " fill="#FEFEFE" filter="url(#f5hde0k0kr1te)" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="1716" x2="1858" y1="1563.1797" y2="1563.1797"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="129" x="1720" y="1556.7627">TASK EXECUTION LAYER</text><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacing" textLength="33" x="1784.5" y="1576.5986">«task»</text><!--MD5=[3e48907bd97ade0542b67fae3325eb92]
cluster **ARTIFACT SYSTEM**--><path d="M1078,1550.8438 L1175,1550.8438 A7.5,7.5 0 0 1 1180,1555.8438 L1187,1570.6797 L1240,1570.6797 A5,5 0 0 1 1245,1575.6797 L1245,1871.3438 A5,5 0 0 1 1240,1876.3438 L1078,1876.3438 A5,5 0 0 1 1073,1871.3438 L1073,1555.8438 A5,5 0 0 1 1078,1550.8438 " fill="#FEFEFE" filter="url(#f5hde0k0kr1te)" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="1073" x2="1187" y1="1570.6797" y2="1570.6797"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="101" x="1077" y="1564.2627">ARTIFACT SYSTEM</text><!--MD5=[8f149d3ff5a29feaeca4735ddec664bc]
cluster **RAG LAYER**--><path d="M2327,1971.8438 L2384,1971.8438 A7.5,7.5 0 0 1 2389,1976.8438 L2396,1991.6797 L2467,1991.6797 A5,5 0 0 1 2472,1996.6797 L2472,2220.8438 A5,5 0 0 1 2467,2225.8438 L2327,2225.8438 A5,5 0 0 1 2322,2220.8438 L2322,1976.8438 A5,5 0 0 1 2327,1971.8438 " fill="#FEFEFE" filter="url(#f5hde0k0kr1te)" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="2322" x2="2396" y1="1991.6797" y2="1991.6797"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="61" x="2326" y="1985.2627">RAG LAYER</text><!--MD5=[103796216b7f31ff20ade2d8b3e0865b]
cluster **INGESTION LAYER**--><path d="M2262,1326.8438 L2352,1326.8438 A7.5,7.5 0 0 1 2357,1331.8438 L2364,1346.6797 L2547,1346.6797 A5,5 0 0 1 2552,1351.6797 L2552,1431.8438 A5,5 0 0 1 2547,1436.8438 L2262,1436.8438 A5,5 0 0 1 2257,1431.8438 L2257,1331.8438 A5,5 0 0 1 2262,1326.8438 " fill="#FEFEFE" filter="url(#f5hde0k0kr1te)" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="2257" x2="2364" y1="1346.6797" y2="1346.6797"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="94" x="2261" y="1340.2627">INGESTION LAYER</text><!--MD5=[88f919cc70c6e2f8b4a45820d743cff8]
cluster **DATA LAYER** - Persistence--><path d="M2908,2317.8438 L3049,2317.8438 A7.5,7.5 0 0 1 3054,2322.8438 L3061,2337.6797 L3406,2337.6797 A5,5 0 0 1 3411,2342.6797 L3411,2491.8438 A5,5 0 0 1 3406,2496.8438 L2908,2496.8438 A5,5 0 0 1 2903,2491.8438 L2903,2322.8438 A5,5 0 0 1 2908,2317.8438 " fill="#FEFEFE" filter="url(#f5hde0k0kr1te)" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="2903" x2="3061" y1="2337.6797" y2="2337.6797"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="68" x="2907" y="2331.2627">DATA LAYER</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="74" x="2978" y="2331.2627">- Persistence</text><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacing" textLength="33" x="3144.5" y="2351.0986">«data»</text><!--MD5=[4b4aa12fd50f56bd13a7a0170aaccc36]
entity dashboard--><rect fill="#FEFECE" filter="url(#f5hde0k0kr1te)" height="61.5078" rx="5" ry="5" style="stroke:#000000;stroke-width:2.0;" width="124" x="22" y="432.8438"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="11" x="32" y="454.2627">&#128202;</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="90" x="46" y="454.2627">Case Dashboard</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="85" x="32" y="468.0986">Case list, metrics,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="98" x="32" y="481.9346">filtering, status view</text><!--MD5=[4af8dce8cff07d067cf4221318aaa363]
entity copilot--><rect fill="#FEFECE" filter="url(#f5hde0k0kr1te)" height="75.3438" rx="5" ry="5" style="stroke:#000000;stroke-width:2.0;" width="104" x="388" y="426.3438"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="11" x="398" y="447.7627">&#128172;</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="70" x="412" y="447.7627">Case Copilot</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="71" x="398" y="461.5986">Chat interface,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="74" x="398" y="475.4346">artifact display,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="43" x="398" y="489.2705">audit trail</text><!--MD5=[87ce26710ac76f4f5901bc8fd9789d9e]
entity knowledge--><rect fill="#FEFECE" filter="url(#f5hde0k0kr1te)" height="61.5078" rx="5" ry="5" style="stroke:#000000;stroke-width:2.0;" width="171" x="181.5" y="432.8438"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="11" x="191.5" y="454.2627">&#128193;</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="137" x="205.5" y="454.2627">Knowledge Management</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="86" x="191.5" y="468.0986">Document upload,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="67" x="191.5" y="481.9346">data ingestion</text><!--MD5=[6be96040792a0cd556c535244c12ec70]
entity api_client--><rect fill="#FEFECE" filter="url(#f5hde0k0kr1te)" height="61.5078" rx="5" ry="5" style="stroke:#000000;stroke-width:2.0;" width="148" x="280" y="668.8438"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="11" x="290" y="690.2627">&#128268;</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="53" x="304" y="690.2627">API Client</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="128" x="290" y="704.0986">HTTP/REST communication</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="79" x="290" y="717.9346">or Direct imports</text><!--MD5=[e2307af040e3f87d22824e7603ca28ec]
entity api--><rect fill="#FEFECE" filter="url(#f5hde0k0kr1te)" height="61.5078" rx="5" ry="5" style="stroke:#000000;stroke-width:2.0;" width="141" x="1714.5" y="885.8438"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="11" x="1724.5" y="907.2627">&#127760;</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="48" x="1738.5" y="907.2627">REST API</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="121" x="1724.5" y="921.0986">/cases, /chat, /decisions,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="70" x="1724.5" y="934.9346">/ingest, /health</text><!--MD5=[789e23807450d0f32381ad58adade5f0]
entity chat_svc--><rect fill="#FEFECE" filter="url(#f5hde0k0kr1te)" height="103.0156" rx="5" ry="5" style="stroke:#000000;stroke-width:2.0;" width="134" x="1918" y="1089.3438"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="11" x="1928" y="1110.7627">&#128172;</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="69" x="1942" y="1110.7627">Chat Service</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="104" x="1928" y="1124.5986">Message processing,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="72" x="1928" y="1138.4346">intent handling,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="97" x="1928" y="1152.2705">response formatting</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="114" x="1928" y="1166.1064">+ Conversation memory</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="82" x="1928" y="1179.9424">+ Cost estimation</text><!--MD5=[fcf377f22f7879951f7f547416a5ec68]
entity conv_mgr--><rect fill="#FEFECE" filter="url(#f5hde0k0kr1te)" height="89.1797" rx="5" ry="5" style="stroke:#000000;stroke-width:2.0;" width="146" x="2064" y="1345.3438"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="126" x="2074" y="1366.7627">&#128190; **Conversation Context</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="50" x="2074" y="1380.5986">Manager**</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="82" x="2074" y="1394.4346">Context retrieval,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="87" x="2074" y="1408.2705">message storage,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="103" x="2074" y="1422.1064">cost-aware selection</text><!--MD5=[252e12d2df198ece75d7fc8077b9d9d4]
entity case_svc--><rect fill="#FEFECE" filter="url(#f5hde0k0kr1te)" height="75.3438" rx="5" ry="5" style="stroke:#000000;stroke-width:2.0;" width="121" x="2043.5" y="1582.8438"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="11" x="2053.5" y="1604.2627">&#128203;</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="72" x="2067.5" y="1604.2627">Case Service</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="59" x="2053.5" y="1618.0986">Case CRUD,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="101" x="2053.5" y="1631.9346">artifact management,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="84" x="2053.5" y="1645.7705">state persistence</text><!--MD5=[c302a21b22525181f366f2bd9dea10ca]
entity ingest_svc--><rect fill="#FEFECE" filter="url(#f5hde0k0kr1te)" height="61.5078" rx="5" ry="5" style="stroke:#000000;stroke-width:2.0;" width="130" x="2087" y="1109.8438"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="11" x="2097" y="1131.2627">&#128229;</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="96" x="2111" y="1131.2627">Ingestion Service</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="103" x="2097" y="1145.0986">Upload orchestration,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="45" x="2097" y="1158.9346">validation</text><!--MD5=[7342edd9a184d8607391f4c130efbf01]
entity router--><rect fill="#FEFECE" filter="url(#f5hde0k0kr1te)" height="103.0156" rx="5" ry="5" style="stroke:#000000;stroke-width:2.0;" width="207" x="2048.5" y="648.3438"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="8" x="2058.5" y="669.7627">&#129504;</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="72" x="2069.5" y="669.7627">Intent Router</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="115" x="2058.5" y="683.5986">LLM-First Classification:</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="187" x="2058.5" y="697.4346">• LLM with structured output (primary)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="172" x="2058.5" y="711.2705">• Aggressive caching (500 entries)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="135" x="2058.5" y="725.1064">• Rule fallback (errors only)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="169" x="2058.5" y="738.9424">• Two-level (UserGoal+WorkType)</text><!--MD5=[203532b68035934a929f249a5fd26f91]
entity state_mgr--><rect fill="#FEFECE" filter="url(#f5hde0k0kr1te)" height="75.3438" rx="5" ry="5" style="stroke:#000000;stroke-width:2.0;" width="124" x="2132" y="879.3438"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="11" x="2142" y="900.7627">&#128202;</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="79" x="2156" y="900.7627">State Manager</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="93" x="2142" y="914.5986">DTP stage tracking,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="104" x="2142" y="928.4346">validation, transitions,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="88" x="2142" y="942.2705">ONLY state writer</text><!--MD5=[75390d3fefe5b03c70cb446d957a6395]
entity planner--><rect fill="#FEFECE" filter="url(#f5hde0k0kr1te)" height="61.5078" rx="5" ry="5" style="stroke:#000000;stroke-width:2.0;" width="114" x="1983" y="885.8438"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="11" x="1993" y="907.2627">&#128203;</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="80" x="2007" y="907.2627">Action Planner</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="78" x="1993" y="921.0986">Agent selection,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="63" x="1993" y="934.9346">task planning</text><!--MD5=[0cd6d143226e0aa5e0d21836b7b0a6b9]
entity signal_agent--><rect fill="#FEFECE" filter="url(#f5hde0k0kr1te)" height="152.5234" rx="5" ry="5" style="stroke:#000000;stroke-width:2.0;" width="158" x="1318" y="1313.3438"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="11" x="1328" y="1334.7627">&#128225;</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="85" x="1342" y="1334.7627">Sourcing Signal</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="43" x="1328" y="1348.5986">(DTP-01)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="79" x="1328" y="1362.4346">Signal detection,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="79" x="1328" y="1376.2705">urgency scoring</text><line style="stroke:#000000;stroke-width:1.0;" x1="1319" x2="1475" y1="1378.6875" y2="1378.6875"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="38" x="1328" y="1394.1064">Inputs:</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="138" x="1328" y="1407.9424">Case: trigger_source, status</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="123" x="1328" y="1421.7783">Perf: overall_score, trend</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="122" x="1328" y="1435.6143">Spend: variance_percent</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="66" x="1328" y="1449.4502">SLA: severity</text><!--MD5=[38d537fee585efdef8f1c38976a87a4e]
entity supplier_agent--><rect fill="#FEFECE" filter="url(#f5hde0k0kr1te)" height="138.6875" rx="5" ry="5" style="stroke:#000000;stroke-width:2.0;" width="155" x="1511.5" y="1320.3438"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="9" x="1521.5" y="1341.7627">⭐</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="91" x="1533.5" y="1341.7627">Supplier Scoring</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="43" x="1521.5" y="1355.5986">(DTP-02)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="93" x="1521.5" y="1369.4346">Evaluation, ranking,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="77" x="1521.5" y="1383.2705">eligibility checks</text><line style="stroke:#000000;stroke-width:1.0;" x1="1512.5" x2="1665.5" y1="1385.6875" y2="1385.6875"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="38" x="1521.5" y="1401.1064">Inputs:</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="135" x="1521.5" y="1414.9424">Perf: quality_score, delivery</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="84" x="1521.5" y="1428.7783">RFP: eval_criteria</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="97" x="1521.5" y="1442.6143">Market: benchmarks</text><!--MD5=[2e2995ad3460f19375202185c2494efe]
entity rfx_agent--><rect fill="#FEFECE" filter="url(#f5hde0k0kr1te)" height="124.8516" rx="5" ry="5" style="stroke:#000000;stroke-width:2.0;" width="138" x="1145" y="1327.3438"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="11" x="1155" y="1348.7627">&#128221;</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="48" x="1169" y="1348.7627">RFx Draft</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="43" x="1155" y="1362.5986">(DTP-03)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="110" x="1155" y="1376.4346">RFI/RFP/RFQ assembly</text><line style="stroke:#000000;stroke-width:1.0;" x1="1146" x2="1282" y1="1378.8516" y2="1378.8516"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="38" x="1155" y="1394.2705">Inputs:</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="118" x="1155" y="1408.1064">Docs: proposals, quotes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="94" x="1155" y="1421.9424">Policy: eval_rubrics</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="89" x="1155" y="1435.7783">Past: comparisons</text><!--MD5=[74e2ddb0a0f069b766dc019571ca4d61]
entity negotiation_agent--><rect fill="#FEFECE" filter="url(#f5hde0k0kr1te)" height="138.6875" rx="5" ry="5" style="stroke:#000000;stroke-width:2.0;" width="149" x="960.5" y="1320.3438"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="11" x="970.5" y="1341.7627">&#129309;</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="109" x="984.5" y="1341.7627">Negotiation Support</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="43" x="970.5" y="1355.5986">(DTP-04)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="92" x="970.5" y="1369.4346">Leverage analysis,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="83" x="970.5" y="1383.2705">targets, playbook</text><line style="stroke:#000000;stroke-width:1.0;" x1="961.5" x2="1108.5" y1="1385.6875" y2="1385.6875"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="38" x="970.5" y="1401.1064">Inputs:</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="100" x="970.5" y="1414.9424">Market: rates, trends</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="129" x="970.5" y="1428.7783">History: relationship_score</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="98" x="970.5" y="1442.6143">Strategy: batna_info</text><!--MD5=[ccf4e69e9afbd78ce1de2289ef8f24ff]
entity contract_agent--><rect fill="#FEFECE" filter="url(#f5hde0k0kr1te)" height="138.6875" rx="5" ry="5" style="stroke:#000000;stroke-width:2.0;" width="143" x="782.5" y="1320.3438"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="11" x="792.5" y="1341.7627">&#128196;</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="94" x="806.5" y="1341.7627">Contract Support</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="43" x="792.5" y="1355.5986">(DTP-05)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="78" x="792.5" y="1369.4346">Term extraction,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="89" x="792.5" y="1383.2705">validation, handoff</text><line style="stroke:#000000;stroke-width:1.0;" x1="783.5" x2="924.5" y1="1385.6875" y2="1385.6875"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="38" x="792.5" y="1401.1064">Inputs:</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="112" x="792.5" y="1414.9424">KB: contract_templates</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="114" x="792.5" y="1428.7783">State: negotiated_terms</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="123" x="792.5" y="1442.6143">Policy: compliance_check</text><!--MD5=[a6af673e7c9d46cd5b69a9a1146c0c0c]
entity impl_agent--><rect fill="#FEFECE" filter="url(#f5hde0k0kr1te)" height="138.6875" rx="5" ry="5" style="stroke:#000000;stroke-width:2.0;" width="121" x="1701.5" y="1320.3438"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="11" x="1711.5" y="1341.7627">&#128640;</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="87" x="1725.5" y="1341.7627">Implementation</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="43" x="1711.5" y="1355.5986">(DTP-06)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="78" x="1711.5" y="1369.4346">Rollout planning,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="66" x="1711.5" y="1383.2705">value capture</text><line style="stroke:#000000;stroke-width:1.0;" x1="1702.5" x2="1821.5" y1="1385.6875" y2="1385.6875"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="38" x="1711.5" y="1401.1064">Inputs:</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="87" x="1711.5" y="1414.9424">KB: rollout_guides</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="88" x="1711.5" y="1428.7783">Contract: kpi_defs</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="77" x="1711.5" y="1442.6143">Plan: milestones</text><!--MD5=[a69ffa393f4828dd55768dd05a07bdd7]
entity task_rules--><rect fill="#FEFECE" filter="url(#f5hde0k0kr1te)" height="61.5078" rx="5" ry="5" style="stroke:#000000;stroke-width:2.0;" width="122" x="1735" y="1589.3438"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="14" x="1745" y="1610.7627">1️⃣</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="31" x="1762" y="1610.7627">Rules</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="102" x="1745" y="1624.5986">Deterministic checks,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="76" x="1745" y="1638.4346">policy validation</text><!--MD5=[e6562574f0672370c29c27bdece53b46]
entity task_retrieval--><rect fill="#FEFECE" filter="url(#f5hde0k0kr1te)" height="61.5078" rx="5" ry="5" style="stroke:#000000;stroke-width:2.0;" width="115" x="1744.5" y="1791.8438"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="14" x="1754.5" y="1813.2627">2️⃣</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="48" x="1771.5" y="1813.2627">Retrieval</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="95" x="1754.5" y="1827.0986">ChromaDB + SQLite</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="82" x="1754.5" y="1840.9346">query, grounding</text><!--MD5=[2a857a500a5a28ae0250c040aafd948c]
entity task_analytics--><rect fill="#FEFECE" filter="url(#f5hde0k0kr1te)" height="61.5078" rx="5" ry="5" style="stroke:#000000;stroke-width:2.0;" width="129" x="1732.5" y="2003.8438"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="14" x="1742.5" y="2025.2627">3️⃣</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="50" x="1759.5" y="2025.2627">Analytics</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="109" x="1742.5" y="2039.0986">Scoring, normalization,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="97" x="1742.5" y="2052.9346">comparison, ranking</text><!--MD5=[a01003f875e5153ce9664344efeb5900]
entity task_llm--><rect fill="#FEFECE" filter="url(#f5hde0k0kr1te)" height="61.5078" rx="5" ry="5" style="stroke:#000000;stroke-width:2.0;" width="122" x="1733" y="2154.8438"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="14" x="1743" y="2176.2627">4️⃣</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="24" x="1760" y="2176.2627">LLM</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="102" x="1743" y="2190.0986">Narration, summaries</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="80" x="1743" y="2203.9346">(last resort only)</text><!--MD5=[6d140ca06fa3e705ccff803348b39241]
entity artifact_builder--><rect fill="#FEFECE" filter="url(#f5hde0k0kr1te)" height="75.3438" rx="5" ry="5" style="stroke:#000000;stroke-width:2.0;" width="125" x="1096.5" y="1785.3438"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="11" x="1106.5" y="1806.7627">&#128230;</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="82" x="1120.5" y="1806.7627">Artifact Builder</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="68" x="1106.5" y="1820.5986">Pack creation,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="89" x="1106.5" y="1834.4346">verification status,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="105" x="1106.5" y="1848.2705">grounding references</text><!--MD5=[09b6c84ea678f301e5c93c4a867bdcc0]
entity exec_metadata--><rect fill="#FEFECE" filter="url(#f5hde0k0kr1te)" height="75.3438" rx="5" ry="5" style="stroke:#000000;stroke-width:2.0;" width="140" x="1089" y="1582.8438"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="11" x="1099" y="1604.2627">&#128202;</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="106" x="1113" y="1604.2627">Execution Metadata</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="71" x="1099" y="1618.0986">Tokens, costs,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="57" x="1099" y="1631.9346">task details,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="82" x="1099" y="1645.7705">retrieval sources</text><!--MD5=[200b716258823f6794d107a60a287b95]
entity retriever--><rect fill="#FEFECE" filter="url(#f5hde0k0kr1te)" height="61.5078" rx="5" ry="5" style="stroke:#000000;stroke-width:2.0;" width="104" x="2338" y="2003.8438"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="11" x="2348" y="2025.2627">&#128269;</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="51" x="2362" y="2025.2627">Retriever</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="84" x="2348" y="2039.0986">Semantic search,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="68" x="2348" y="2052.9346">metadata filter</text><!--MD5=[264d3d63eb61e1fd66af9e1f62e9323f]
entity vector_store--><rect fill="#FEFECE" filter="url(#f5hde0k0kr1te)" height="47.6719" rx="5" ry="5" style="stroke:#000000;stroke-width:2.0;" width="116" x="2340" y="2161.8438"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="11" x="2350" y="2183.2627">&#128230;</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="70" x="2364" y="2183.2627">Vector Store</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="96" x="2350" y="2197.0986">ChromaDB wrapper</text><!--MD5=[2a2950fbda473123fd240cac98ab0d09]
entity doc_ingest--><rect fill="#FEFECE" filter="url(#f5hde0k0kr1te)" height="61.5078" rx="5" ry="5" style="stroke:#000000;stroke-width:2.0;" width="116" x="2420" y="1358.8438"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="11" x="2430" y="1380.2627">&#128196;</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="58" x="2444" y="1380.2627">Doc Ingest</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="79" x="2430" y="1394.0986">PDF, DOCX, TXT</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="96" x="2430" y="1407.9346">→ chunks → embed</text><!--MD5=[041600926ccb4e61c3a8a25e56a6d9c6]
entity data_ingest--><rect fill="#FEFECE" filter="url(#f5hde0k0kr1te)" height="61.5078" rx="5" ry="5" style="stroke:#000000;stroke-width:2.0;" width="111" x="2273.5" y="1358.8438"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="11" x="2283.5" y="1380.2627">&#128202;</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="61" x="2297.5" y="1380.2627">Data Ingest</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="54" x="2283.5" y="1394.0986">CSV, Excel</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="91" x="2283.5" y="1407.9346">→ validate → store</text><!--MD5=[7a603111606425ec6ae263a7f93634a1]
entity sqlite--><rect fill="#FEFECE" filter="url(#f5hde0k0kr1te)" height="116.8516" rx="5" ry="5" style="stroke:#000000;stroke-width:2.0;" width="145" x="3093.5" y="2363.8438"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="17" x="3103.5" y="2385.2627">&#128452;️</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="36" x="3123.5" y="2385.2627">SQLite</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="48" x="3103.5" y="2399.0986">Data Lake</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="41" x="3103.5" y="2412.9346">• Cases</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="75" x="3103.5" y="2426.7705">• ArtifactPacks</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="82" x="3103.5" y="2440.6064">• ChatMessages</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="104" x="3103.5" y="2454.4424">• Execution Metadata</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="125" x="3103.5" y="2468.2783">• Suppliers, Spend, SLAs</text><!--MD5=[517a3f92df6edbb3e5cf89f46e19ead8]
entity chromadb--><rect fill="#FEFECE" filter="url(#f5hde0k0kr1te)" height="75.3438" rx="5" ry="5" style="stroke:#000000;stroke-width:2.0;" width="139" x="2919.5" y="2384.8438"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="8" x="2929.5" y="2406.2627">&#129522;</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="58" x="2940.5" y="2406.2627">ChromaDB</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="62" x="2929.5" y="2420.0986">Vector Store</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="119" x="2929.5" y="2433.9346">• Document embeddings</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="91" x="2929.5" y="2447.7705">• Semantic search</text><!--MD5=[82f23cda116f7491e2ad662b9686858a]
entity files--><rect fill="#FEFECE" filter="url(#f5hde0k0kr1te)" height="61.5078" rx="5" ry="5" style="stroke:#000000;stroke-width:2.0;" width="121" x="3273.5" y="2391.3438"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="11" x="3283.5" y="2412.7627">&#128193;</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="26" x="3297.5" y="2412.7627">Files</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="101" x="3283.5" y="2426.5986">Uploaded documents</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="90" x="3283.5" y="2440.4346">Synthetic test data</text><!--MD5=[576713d34b70cd01e0fe64aa18bc23e4]
entity human--><rect fill="#FFEBEE" filter="url(#f5hde0k0kr1te)" height="61.5078" rx="5" ry="5" style="stroke:#C62828;stroke-width:2.0;" width="147" x="242.5" y="229.3438"/><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacing" textLength="45" x="293.5" y="250.7627">«human»</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="11" x="252.5" y="264.5986">&#128100;</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="113" x="266.5" y="264.5986">Procurement Officer</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="118" x="252.5" y="278.4346">(Human Decision-Maker)</text><!--MD5=[363cc6da13d8bcdcb0851ce1cf6e8377]
entity llm--><rect fill="#E8E8E8" filter="url(#f5hde0k0kr1te)" height="61.5078" rx="5" ry="5" style="stroke:#999999;stroke-width:2.0;" width="109" x="736.5" y="2391.3438"/><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacing" textLength="52" x="765" y="2412.7627">«external»</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="11" x="746.5" y="2426.5986">&#129302;</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="75" x="760.5" y="2426.5986">OpenAI GPT-4</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="71" x="746.5" y="2440.4346">(LLM Provider)</text><path d="M2592.5,637.3438 L2592.5,695.8438 L2255.78,699.8438 L2592.5,703.8438 L2592.5,761.8672 A5,5 0 0 0 2597.5,766.8672 L2858.5,766.8672 A5,5 0 0 0 2863.5,761.8672 L2863.5,642.3438 L2853.5,632.3438 L2597.5,632.3438 A5,5 0 0 0 2592.5,637.3438 " fill="#FBFB77" filter="url(#f5hde0k0kr1te)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M2853.5,632.3438 L2853.5,639.8438 A2.5,2.5 0 0 0 2856,642.3438 L2863.5,642.3438 L2853.5,632.3438 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="165" x="2598.5" y="648.7627">LLM-First Intent Classification</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="186" x="2598.5" y="662.5986">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="169" x="2598.5" y="676.4346">1. LLM classification (primary path)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="189" x="2598.5" y="690.2705">2. Structured output (Pydantic schema)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="174" x="2598.5" y="704.1064">3. Aggressive caching (500 entries)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="172" x="2598.5" y="717.9424">4. Two-level: UserGoal + WorkType</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="250" x="2598.5" y="731.7783">5. Context-aware (DTP stage, conversation history)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="137" x="2598.5" y="745.6143">6. Rule fallback (errors only)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="155" x="2598.5" y="759.4502">7. Few-shot examples in prompt</text><path d="M2834.5,1767.3438 L2834.5,1878.0313 A5,5 0 0 0 2839.5,1883.0313 L3036.5,1883.0313 A5,5 0 0 0 3041.5,1878.0313 L3041.5,1772.3438 L3031.5,1762.3438 L2839.5,1762.3438 A5,5 0 0 0 2834.5,1767.3438 " fill="#FBFB77" filter="url(#f5hde0k0kr1te)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M3031.5,1762.3438 L3031.5,1769.8438 A2.5,2.5 0 0 0 3034,1772.3438 L3041.5,1772.3438 L3031.5,1762.3438 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="138" x="2840.5" y="1778.7627">Task Execution Hierarchy</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="186" x="2840.5" y="1792.5986">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="142" x="2840.5" y="1806.4346">All agents follow same order:</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="110" x="2840.5" y="1820.2705">1. Rules (deterministic)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="134" x="2840.5" y="1834.1064">2. Retrieval (ground in data)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="111" x="2840.5" y="1847.9424">3. Analytics (calculate)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="101" x="2840.5" y="1861.7783">4. LLM (narrate only)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="101" x="2840.5" y="1875.6143">⚠️ Never skip steps</text><path d="M2592.5,861.3438 L2592.5,972.0313 A5,5 0 0 0 2597.5,977.0313 L2794.5,977.0313 A5,5 0 0 0 2799.5,972.0313 L2799.5,866.3438 L2789.5,856.3438 L2597.5,856.3438 A5,5 0 0 0 2592.5,861.3438 " fill="#FBFB77" filter="url(#f5hde0k0kr1te)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M2789.5,856.3438 L2789.5,863.8438 A2.5,2.5 0 0 0 2792,866.3438 L2799.5,866.3438 L2789.5,856.3438 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="130" x="2598.5" y="872.7627">Supervisor Governance</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="186" x="2598.5" y="886.5986">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="150" x="2598.5" y="900.4346">• ONLY component that writes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="51" x="2604.5" y="914.2705">case state</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="121" x="2598.5" y="928.1064">• Validates all transitions</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="134" x="2598.5" y="941.9424">• Enforces human approval</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="128" x="2598.5" y="955.7783">• Blocks invalid DTP jumps</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="92" x="2598.5" y="969.6143">• Logs all changes</text><path d="M2592.5,1753.8438 L2592.5,1892.2031 A5,5 0 0 0 2597.5,1897.2031 L2794.5,1897.2031 A5,5 0 0 0 2799.5,1892.2031 L2799.5,1758.8438 L2789.5,1748.8438 L2597.5,1748.8438 A5,5 0 0 0 2592.5,1753.8438 " fill="#FBFB77" filter="url(#f5hde0k0kr1te)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M2789.5,1748.8438 L2789.5,1756.3438 A2.5,2.5 0 0 0 2792,1758.8438 L2799.5,1758.8438 L2789.5,1748.8438 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="85" x="2598.5" y="1765.2627">Artifact System</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="186" x="2598.5" y="1779.0986">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="137" x="2598.5" y="1792.9346">• ArtifactPacks with multiple</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="40" x="2604.5" y="1806.7705">artifacts</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="152" x="2598.5" y="1820.6064">• Verification status (VERIFIED/</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="108" x="2604.5" y="1834.4424">PARTIAL/UNVERIFIED)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="117" x="2598.5" y="1848.2783">• Grounding references</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="146" x="2598.5" y="1862.1143">• Execution metadata (tokens,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="91" x="2604.5" y="1875.9502">costs, task details)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="72" x="2598.5" y="1889.7861">• Full audit trail</text><path d="M2592.5,1327.3438 L2592.5,1451.8672 A5,5 0 0 0 2597.5,1456.8672 L2794.5,1456.8672 A5,5 0 0 0 2799.5,1451.8672 L2799.5,1332.3438 L2789.5,1322.3438 L2597.5,1322.3438 A5,5 0 0 0 2592.5,1327.3438 " fill="#FBFB77" filter="url(#f5hde0k0kr1te)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M2789.5,1322.3438 L2789.5,1329.8438 A2.5,2.5 0 0 0 2792,1332.3438 L2799.5,1332.3438 L2789.5,1322.3438 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="123" x="2598.5" y="1338.7627">Conversation Memory</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="87" x="2598.5" y="1352.5986">(Optional Feature)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="186" x="2598.5" y="1366.4346">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="105" x="2598.5" y="1380.2705">• Enabled via env var</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="153" x="2598.5" y="1394.1064">• Cost-aware context selection</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="152" x="2598.5" y="1407.9424">• Pre-execution cost estimation</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="161" x="2598.5" y="1421.7783">• Backward compatible (disabled</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="52" x="2604.5" y="1435.6143">by default)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="155" x="2598.5" y="1449.4502">• Messages persist in database</text><path d="M212.5,66.3438 L212.5,163.1953 A5,5 0 0 0 217.5,168.1953 L312,168.1953 L316,229.2638 L320,168.1953 L414.5,168.1953 A5,5 0 0 0 419.5,163.1953 L419.5,71.3438 L409.5,61.3438 L217.5,61.3438 A5,5 0 0 0 212.5,66.3438 " fill="#FBFB77" filter="url(#f5hde0k0kr1te)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M409.5,61.3438 L409.5,68.8438 A2.5,2.5 0 0 0 412,71.3438 L419.5,71.3438 L409.5,61.3438 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="106" x="218.5" y="77.7627">Human-in-the-Loop</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="186" x="218.5" y="91.5986">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="146" x="218.5" y="105.4346">✅ Approve → Advance stage</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="141" x="218.5" y="119.2705">✏️ Edit → Modify &amp; resubmit</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="124" x="218.5" y="133.1064">❌ Reject → Stay at stage</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="0" x="221.5" y="146.9424"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="131" x="218.5" y="160.7783">AI advises, Human decides</text><path d="M3062.5,2548.8438 L3062.5,2867.0703 A5,5 0 0 0 3067.5,2872.0703 L3264.5,2872.0703 A5,5 0 0 0 3269.5,2867.0703 L3269.5,2553.8438 L3259.5,2543.8438 L3170,2543.8438 L3166,2481.0538 L3162,2543.8438 L3067.5,2543.8438 A5,5 0 0 0 3062.5,2548.8438 " fill="#FBFB77" filter="url(#f5hde0k0kr1te)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M3259.5,2543.8438 L3259.5,2551.3438 A2.5,2.5 0 0 0 3262,2553.8438 L3269.5,2553.8438 L3259.5,2543.8438 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="163" x="3068.5" y="2560.2627">DTP Stage Data Requirements</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="186" x="3068.5" y="2574.0986">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="86" x="3068.5" y="2587.9346">DTP-01 Strategy</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="3" x="3154.5" y="2587.9346">:</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="177" x="3068.5" y="2601.7705">• SupplierPerformance, SpendMetric</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="159" x="3068.5" y="2615.6064">• SLAEvent, Market Benchmarks</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="0" x="3071.5" y="2629.4424"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="87" x="3068.5" y="2643.2783">DTP-02 Planning</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="3" x="3155.5" y="2643.2783">:</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="169" x="3068.5" y="2657.1143">• Evaluation criteria, RFP templates</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="85" x="3068.5" y="2670.9502">• Supplier longlist</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="0" x="3071.5" y="2684.7861"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="89" x="3068.5" y="2698.6221">DTP-03 Sourcing</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="3" x="3157.5" y="2698.6221">:</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="150" x="3068.5" y="2712.458">• Proposals, Evaluation rubrics</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="116" x="3068.5" y="2726.2939">• Comparison templates</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="0" x="3071.5" y="2740.1299"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="102" x="3068.5" y="2753.9658">DTP-04 Negotiation</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="3" x="3170.5" y="2753.9658">:</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="133" x="3068.5" y="2767.8018">• Market rates, BATNA info</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="98" x="3068.5" y="2781.6377">• Alternative quotes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="0" x="3071.5" y="2795.4736"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="104" x="3068.5" y="2809.3096">DTP-05 Contracting</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="3" x="3172.5" y="2809.3096">:</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="162" x="3068.5" y="2823.1455">• Contract templates, Legal terms</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="0" x="3071.5" y="2836.9814"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="127" x="3068.5" y="2850.8174">DTP-06 Implementation</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="3" x="3195.5" y="2850.8174">:</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="134" x="3068.5" y="2864.6533">• Migration guides, KPI defs</text><!--MD5=[be91230b1f798049f038b9378dd1c98d]
link human to copilot--><path d="M334.56,291.5138 C355.86,326.1138 390.89,383.0437 414.68,421.6937 " fill="none" id="human-to-copilot" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="417.52,426.3137,416.2189,416.5512,414.9035,422.053,409.4017,420.7376,417.52,426.3137" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="78" x="383.5" y="340.7627">Asks questions,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="87" x="379" y="354.5986">Approves/Rejects</text><!--MD5=[5ea3f2550e3ee438cfa310b4849842cc]
link copilot to human--><path d="M464.14,426.2137 C480.86,395.7838 496.59,352.5637 475,321.3438 C456.6,294.7337 424.8,279.9138 394.45,271.6638 " fill="none" id="copilot-to-human" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="389.59,270.3938,397.2962,276.5268,394.4296,271.65,399.3063,268.7834,389.59,270.3938" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="91" x="487" y="333.7627">Recommendations,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="88" x="488.5" y="347.5986">Evidence, Pending</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="44" x="510.5" y="361.4346">Approval</text><!--MD5=[c206d04f5c05282be3b9082ddffebc94]
link human to dashboard--><path d="M242.12,277.6337 C213.65,286.7838 182.39,300.6537 159,321.3438 C126.68,349.9338 105.98,395.8638 94.69,427.6038 " fill="none" id="human-to-dashboard" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="92.96,432.5738,99.6989,425.3913,94.6054,427.8522,92.1445,422.7587,92.96,432.5738" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="68" x="160" y="340.7627">Views cases,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="62" x="163" y="354.5986">selects case</text><!--MD5=[2d46e724c441994b3943421d562ace59]
link human to knowledge--><path d="M268.44,291.4637 C258.96,299.8938 250.3,309.9237 245,321.3438 C229.27,355.2337 239.59,398.1138 250.8,427.7337 " fill="none" id="human-to-knowledge" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="252.75,432.7337,253.2204,422.8961,250.9398,428.0729,245.763,425.7924,252.75,432.7337" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="95" x="246" y="340.7627">Uploads documents</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="54" x="266.5" y="354.5986">&amp; data files</text><!--MD5=[7f8e824fe9aa7994c2e2d6c4b588942a]
link dashboard to api_client--><path d="M118.75,494.9538 C169.13,538.6238 262.21,619.2937 314.92,664.9738 " fill="none" id="dashboard-to-api_client" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="318.96,668.4738,314.7824,659.5548,315.183,665.1975,309.5403,665.5981,318.96,668.4738" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[a530ac22912fc87b597c3c1d0d86ddc6]
link copilot to api_client--><path d="M426.56,501.4037 C410.28,545.7137 383.03,619.8538 366.96,663.5738 " fill="none" id="copilot-to-api_client" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="365.15,668.4938,372.0177,661.4344,366.8805,663.8028,364.5121,658.6656,365.15,668.4938" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[d87dbe85e23d88c743093ac364526ad0]
link knowledge to api_client--><path d="M278.2,494.9538 C294.27,538.1838 323.82,617.6838 340.89,663.5938 " fill="none" id="knowledge-to-api_client" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="342.71,668.4738,343.3215,658.6439,340.9669,663.7874,335.8234,661.4328,342.71,668.4738" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[e4218dc8576b5f4727381931811678d0]
link api_client to api--><path d="M428.42,712.0237 C674.57,749.0037 1460.79,867.1338 1709.09,904.4437 " fill="none" id="api_client-to-api" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="1714.14,905.1937,1705.8344,899.9006,1709.1955,904.4507,1704.6455,907.8117,1714.14,905.1937" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="70" x="1160.5" y="809.7627">REST API calls</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="79" x="1156" y="823.5986">or Direct imports</text><!--MD5=[a036f675a3f9fa022f781fbacfeb422f]
link api to case_svc--><path d="M1769.44,948.3238 C1738.72,1013.2338 1679.7,1166.1338 1757,1251.3438 C1769.3,1264.9038 1823.08,1250.2938 1839,1259.3438 C1969.07,1333.2538 2053.51,1499.9738 2087.29,1577.8338 " fill="none" id="api-to-case_svc" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="2089.44,1582.8338,2089.5602,1572.9856,2087.4652,1578.2402,2082.2106,1576.1453,2089.44,1582.8338" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="56" x="1758" y="1241.7627">Case CRUD</text><!--MD5=[34b35cf27b79f55eb3f87c4269c791a5]
link api to chat_svc--><path d="M1786.86,948.0238 C1790.38,976.8638 1800.44,1019.1238 1829,1041.3438 C1843.97,1052.9938 1897.35,1040.2538 1914,1049.3438 C1929.41,1057.7538 1942.61,1071.0638 1953.3,1084.9038 " fill="none" id="api-to-chat_svc" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="1956.53,1089.2138,1954.33,1079.6138,1953.53,1085.2138,1947.93,1084.4138,1956.53,1089.2138" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="75" x="1830" y="1029.2627">Chat messages</text><!--MD5=[98ddd2b50bfd18f9b858b5fdb48551ea]
link api to ingest_svc--><path d="M1855.72,945.4637 C1889.01,957.3938 1929.54,970.4038 1967,978.3438 C2032.31,992.1837 2221.13,957.9137 2266,1007.3438 C2296.27,1040.6938 2253.13,1079.9038 2211.53,1106.9738 " fill="none" id="api-to-ingest_svc" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="2207.25,1109.7138,2216.9859,1108.2267,2211.4601,1107.0165,2212.6703,1101.4906,2207.25,1109.7138" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="57" x="2277" y="1029.2627">File uploads</text><!--MD5=[bea09dea38a14a3a4a71b2625c02a584]
link chat_svc to router--><path d="M2019.73,1089.3438 C2033.41,1073.5938 2050.53,1058.0838 2070,1049.3438 C2084.96,1042.6338 2353.57,1053.0938 2365,1041.3438 C2450.3,953.7037 2318.73,826.3238 2227.43,754.7937 " fill="none" id="chat_svc-to-router" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="2223.38,751.6438,2228.0219,760.3301,2227.3245,754.7164,2232.9381,754.019,2223.38,751.6438" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="70" x="2393" y="914.7627">User message</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="45" x="2405.5" y="928.5986">+ context</text><!--MD5=[a002d5a47346dcc4c939bf650a561910]
link router to state_mgr--><path d="M2161.9,751.5237 C2169.2,788.9138 2179.02,839.1737 2185.87,874.2238 " fill="none" id="router-to-state_mgr" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="2186.86,879.2838,2189.0656,869.685,2185.9041,874.376,2181.2132,871.2144,2186.86,879.2838" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="45" x="2178" y="809.7627">Validates</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="49" x="2176" y="823.5986">DTP stage</text><!--MD5=[fc3b8b9163cc87155d5579adec3990e2]
link router to planner--><path d="M2112.73,751.3538 C2102.58,765.7438 2092.21,781.7438 2084,797.3438 C2069.87,824.1737 2058.18,856.5638 2050.4,880.6937 " fill="none" id="router-to-planner" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="2048.81,885.7137,2055.3514,878.351,2050.3266,880.9493,2047.7283,875.9245,2048.81,885.7137" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="77" x="2085" y="809.7627">Two-level intent</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="67" x="2090" y="823.5986">→ Action Plan</text><!--MD5=[5a5284d5cd3ddfdefc1ea6ecb5db0fef]
link planner to chat_svc--><path d="M2013.52,947.9537 C2003.39,958.3938 1991.3,969.6438 1979,978.3438 C1954.82,995.4537 1934.74,982.2538 1919,1007.3438 C1910.97,1020.1438 1914.6,1026.8838 1919,1041.3438 C1923.57,1056.3838 1931.29,1071.2138 1939.87,1084.6238 " fill="none" id="planner-to-chat_svc" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="1942.81,1089.1138,1941.2228,1079.3936,1940.0695,1084.9317,1934.5315,1083.7784,1942.81,1089.1138" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="70" x="1920" y="1029.2627">Agent + Tasks</text><!--MD5=[26b4aa7942397f83941634b651e9e9c8]
link chat_svc to signal_agent--><path d="M1917.73,1143.5038 C1790.75,1147.9838 1522.22,1164.2438 1453,1222.3438 C1427.61,1243.6538 1413.69,1276.8838 1406.07,1308.0638 " fill="none" id="chat_svc-to-signal_agent" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="1404.9,1313.0438,1410.855,1305.1992,1406.0452,1308.1767,1403.0677,1303.3668,1404.9,1313.0438" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="38" x="1473" y="1234.7627">DTP-01:</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="76" x="1454" y="1248.5986">Signal detection</text><!--MD5=[790fe956f73270b284081bad409f2225]
link chat_svc to supplier_agent--><path d="M1917.99,1180.1338 C1897.27,1192.8138 1874.72,1207.4938 1855,1222.3438 C1839.67,1233.8838 1840.7,1243.9238 1823,1251.3438 C1794.46,1263.3038 1711.19,1244.5738 1684,1259.3438 C1660.34,1272.1938 1641.01,1293.7838 1626.12,1315.6738 " fill="none" id="chat_svc-to-supplier_agent" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="1623.2,1320.0538,1631.5122,1314.7709,1625.9669,1315.8891,1624.8487,1310.3439,1623.2,1320.0538" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="38" x="1876" y="1234.7627">DTP-02:</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="78" x="1856" y="1248.5986">Supplier scoring</text><!--MD5=[a2f7feb1f54c3b7f363cea3f8fd777ae]
link chat_svc to rfx_agent--><path d="M1917.89,1140.9938 C1800.8,1141.5638 1553.18,1151.9338 1359,1222.3438 C1311.04,1239.7338 1273.76,1284.0438 1249.01,1322.5838 " fill="none" id="chat_svc-to-rfx_agent" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="1246.06,1327.2538,1254.2486,1321.7814,1248.7305,1323.0266,1247.4852,1317.5086,1246.06,1327.2538" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="38" x="1370.5" y="1234.7627">DTP-03:</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="59" x="1360" y="1248.5986">RFx drafting</text><!--MD5=[3949901e9e66e03116a57fa966d1a22c]
link chat_svc to negotiation_agent--><path d="M1917.86,1141.6638 C1781.84,1142.8438 1464.99,1153.5038 1210,1222.3438 C1171.4,1232.7638 1158.94,1234.0238 1128,1259.3438 C1108.8,1275.0538 1091.65,1295.6438 1077.46,1315.7538 " fill="none" id="chat_svc-to-negotiation_agent" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="1074.48,1320.0438,1082.9074,1314.9467,1077.3387,1315.9416,1076.3439,1310.3729,1074.48,1320.0438" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="38" x="1238.5" y="1234.7627">DTP-04:</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="93" x="1211" y="1248.5986">Negotiation support</text><!--MD5=[f6ed7feefbf401a9e56c9760c6e49598]
link chat_svc to contract_agent--><path d="M1917.79,1144.9738 C1730.28,1154.1238 1204.17,1182.6738 1036,1222.3438 C992.7,1232.5538 977.77,1231.5938 943,1259.3438 C923.69,1274.7538 906.91,1295.4738 893.28,1315.8038 " fill="none" id="chat_svc-to-contract_agent" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="890.42,1320.1338,898.7069,1314.8114,893.167,1315.956,892.0224,1310.4161,890.42,1320.1338" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="38" x="1064" y="1234.7627">DTP-05:</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="92" x="1037" y="1248.5986">Contract extraction</text><!--MD5=[cb406067b9c1c40a6f6cd73292aca573]
link chat_svc to impl_agent--><path d="M1976.74,1192.6038 C1970.77,1213.6838 1960.54,1236.6138 1943,1251.3438 C1928.78,1263.2838 1918.56,1250.9438 1902,1259.3438 C1873.95,1273.5738 1847.44,1295.0838 1825.19,1316.5038 " fill="none" id="chat_svc-to-impl_agent" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="1821.37,1320.2138,1830.6115,1316.8085,1824.9552,1316.7286,1825.0352,1311.0723,1821.37,1320.2138" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="38" x="2002.5" y="1234.7627">DTP-06:</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="113" x="1965" y="1248.5986">Implementation planning</text><!--MD5=[943f2ad30c56fcc303801e409762ca26]
link signal_agent to task_rules--><path d="M1397.01,1466.4338 C1401.02,1489.3938 1409.88,1512.4538 1428,1527.3438 C1440.02,1537.2238 1693.64,1529.3538 1708,1535.3438 C1732.83,1545.7038 1754.73,1566.5438 1770.48,1584.8838 " fill="none" id="signal_agent-to-task_rules" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="1773.94,1588.9938,1771.2166,1579.5289,1770.725,1585.1644,1765.0896,1584.6729,1773.94,1588.9938" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="39" x="1429" y="1517.7627">1. Rules</text><!--MD5=[74dc2fe558412cde636bbbc096127532]
link supplier_agent to task_rules--><path d="M1596.6,1459.4038 C1602.91,1484.4738 1614.35,1510.7238 1635,1527.3438 C1647.72,1537.5738 1693.2,1528.4538 1708,1535.3438 C1732.21,1546.6138 1753.97,1567.2438 1769.8,1585.2338 " fill="none" id="supplier_agent-to-task_rules" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="1773.29,1589.2638,1770.4319,1579.8387,1770.0208,1585.4806,1764.3789,1585.0694,1773.29,1589.2638" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="39" x="1636" y="1517.7627">1. Rules</text><!--MD5=[363da34cf2c605117de3e8ee9d7ae014]
link rfx_agent to task_rules--><path d="M1198.06,1452.6638 C1195.15,1479.1338 1197.84,1508.2938 1217,1527.3438 C1226.67,1536.9638 1695.38,1530.1638 1708,1535.3438 C1733.07,1545.6238 1755.11,1566.7038 1770.87,1585.1638 " fill="none" id="rfx_agent-to-task_rules" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="1774.33,1589.3038,1771.6239,1579.8339,1771.1221,1585.4685,1765.4875,1584.9666,1774.33,1589.3038" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="39" x="1218" y="1517.7627">1. Rules</text><!--MD5=[0672238f0ec3be0568f7224f0fd4cc5a]
link negotiation_agent to task_rules--><path d="M1022.37,1459.4438 C1021.88,1484.2138 1026.83,1510.2438 1045,1527.3438 C1058.41,1539.9638 1690.94,1528.3938 1708,1535.3438 C1733.09,1545.5738 1755.14,1566.6438 1770.88,1585.1238 " fill="none" id="negotiation_agent-to-task_rules" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="1774.35,1589.2738,1771.6473,1579.803,1771.1434,1585.4373,1765.5091,1584.9335,1774.35,1589.2738" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="39" x="1046" y="1517.7627">1. Rules</text><!--MD5=[c8349f64da31b1c95125ca3f7e3a20b5]
link contract_agent to task_rules--><path d="M825.96,1459.4338 C820.75,1483.9038 821.55,1509.7338 839,1527.3438 C855.99,1544.4938 1685.63,1526.2638 1708,1535.3438 C1733.11,1545.5338 1755.15,1566.6138 1770.9,1585.1038 " fill="none" id="contract_agent-to-task_rules" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="1774.36,1589.2438,1771.6539,1579.7739,1771.1521,1585.4085,1765.5175,1584.9066,1774.36,1589.2438" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="39" x="840" y="1517.7627">1. Rules</text><!--MD5=[7ec6ff4238f333e44f3a72eb21b522ef]
link impl_agent to task_rules--><path d="M1794.71,1459.5938 C1799.39,1472.2238 1803.47,1485.4838 1806,1498.3438 C1811.62,1526.9238 1808.26,1559.8938 1803.98,1584.2038 " fill="none" id="impl_agent-to-task_rules" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="1803.05,1589.2538,1808.6245,1581.1343,1803.962,1584.3376,1800.7587,1579.6751,1803.05,1589.2538" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="39" x="1809" y="1517.7627">1. Rules</text><!--MD5=[7756119cb20828552dac7118d9281ef1]
link task_rules to task_retrieval--><path d="M1796.9,1651.3638 C1797.98,1687.5338 1799.8,1748.2238 1800.95,1786.5938 " fill="none" id="task_rules-to-task_retrieval" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="1801.1,1791.6238,1804.8413,1782.5132,1800.9572,1786.6258,1796.8446,1782.7417,1801.1,1791.6238" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="54" x="1799" y="1709.2627">2. Retrieval</text><!--MD5=[7d487bcbef6fca2d9b4667b77b661824]
link task_retrieval to task_analytics--><path d="M1801.28,1853.9338 C1800.37,1892.1338 1798.81,1957.9538 1797.84,1998.5037 " fill="none" id="task_retrieval-to-task_analytics" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="1797.72,2003.8138,1801.9246,1994.9075,1797.8343,1998.8151,1793.9267,1994.7247,1797.72,2003.8138" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="57" x="1800" y="1946.2627">3. Analytics</text><!--MD5=[17d9e8f0180cdfb514eb0354be40ea4d]
link task_analytics to task_llm--><path d="M1796.39,2065.9938 C1795.91,2090.1338 1795.22,2124.0238 1794.71,2149.4438 " fill="none" id="task_analytics-to-task_llm" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="1794.61,2154.7338,1798.7892,2145.8155,1794.71,2149.7347,1790.7908,2145.6556,1794.61,2154.7338" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="32" x="1806.5" y="2108.2627">4. LLM</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="53" x="1796" y="2122.0986">(if needed)</text><!--MD5=[86a09605554f2a283bfd8ab2523b3c31]
link task_retrieval to retriever--><path d="M1859.72,1844.4538 C1972.48,1884.7337 2220.8,1973.4138 2332.99,2013.4837 " fill="none" id="task_retrieval-to-retriever" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="2337.9,2015.2337,2330.754,2008.4562,2333.1874,2013.5629,2328.0807,2015.9963,2337.9,2015.2337" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="86" x="2166" y="1946.2627">Query documents</text><!--MD5=[4c07ac76b67010bc8c59d67f89b66646]
link retriever to vector_store--><path d="M2386.5,2065.9738 C2385.03,2083.2438 2384.06,2105.2938 2386,2124.8438 C2387.03,2135.2838 2389.06,2146.6038 2391.15,2156.5638 " fill="none" id="retriever-to-vector_store" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="2392.25,2161.6438,2394.2562,2152.0014,2391.1926,2156.7568,2386.4371,2153.6932,2392.25,2161.6438" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="81" x="2387" y="2115.2627">Semantic search</text><!--MD5=[d6f5dd3331d9fa0a83a7de4e40d8a450]
link vector_store to chromadb--><path d="M2432.12,2209.9538 C2470.6,2235.2138 2535.68,2275.5738 2596,2301.8438 C2703,2348.4438 2833.81,2384.2938 2914.25,2404.1038 " fill="none" id="vector_store-to-chromadb" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="2919.48,2405.3838,2911.6854,2399.3635,2914.6226,2404.198,2909.7881,2407.1353,2919.48,2405.3838" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="64" x="2597" y="2292.2627">Vector query</text><!--MD5=[09184bf0eeb39c321957df8e7ae1fdb8]
link task_retrieval to sqlite--><path d="M1859.86,1828.2438 C1978.85,1838.9138 2257.79,1872.3938 2472,1963.8438 C2716.33,2068.1538 2714.23,2214.1338 2965,2301.8438 C2988.34,2310.0138 3054.08,2298.3838 3076,2309.8438 C3097.62,2321.1538 3115.89,2340.1638 3130.19,2359.3138 " fill="none" id="task_retrieval-to-sqlite" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="3133.37,2363.6538,3131.2689,2354.0316,3130.4113,2359.6231,3124.8199,2358.7655,3133.37,2363.6538" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="107" x="2708" y="2108.2627">Query structured data</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="123" x="2700" y="2122.0986">(Suppliers, Spend, SLAs)</text><!--MD5=[d5d0ef5c4e0ad0a9025ef2e536d94e80]
link signal_agent to artifact_builder--><path d="M1397.28,1466.4138 C1395.74,1492.8138 1391.84,1518.1638 1383,1527.3438 C1365.25,1545.7638 1346.23,1519.6838 1326,1535.3438 C1256.2,1589.3838 1296.75,1643.9638 1250,1718.8438 C1236.14,1741.0438 1217.44,1763.1338 1200.61,1781.1338 " fill="none" id="signal_agent-to-artifact_builder" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="1196.82,1785.1438,1205.9011,1781.3314,1200.2468,1781.5028,1200.0755,1775.8485,1196.82,1785.1438" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="85" x="1327" y="1625.2627">Build ArtifactPack</text><!--MD5=[45395fb76d71e463a82c669ea3a1ffc6]
link supplier_agent to artifact_builder--><path d="M1598.53,1459.6238 C1600.82,1488.3038 1600.35,1517.2738 1591,1527.3438 C1574.62,1544.9738 1502.72,1521.5438 1483,1535.3438 C1424.5,1576.2938 1465.6,1629.5138 1417,1681.8438 C1364.38,1738.5038 1283.5,1777.1838 1226.34,1799.2838 " fill="none" id="supplier_agent-to-artifact_builder" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="1221.58,1801.1138,1231.4168,1801.6002,1226.2438,1799.3112,1228.5327,1794.1381,1221.58,1801.1138" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="85" x="1484" y="1625.2627">Build ArtifactPack</text><!--MD5=[5cd3f1ea2b51fdd97bb02e3366e378ca]
link rfx_agent to artifact_builder--><path d="M1171.35,1452.4638 C1158.63,1466.8738 1143.6,1480.7838 1127,1490.3438 C1110.91,1499.6138 1102.23,1489.3338 1086,1498.3438 C1070.6,1506.8938 1074.75,1519.4538 1059,1527.3438 C1044.21,1534.7538 996.05,1523.0338 985,1535.3438 C941.5,1583.7938 956.88,1623.1238 985,1681.8438 C1007.13,1728.0438 1052.77,1763.8538 1091.75,1787.6838 " fill="none" id="rfx_agent-to-artifact_builder" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="1096.47,1790.5338,1090.8422,1782.4512,1092.1927,1787.9445,1086.6994,1789.2949,1096.47,1790.5338" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="85" x="986" y="1625.2627">Build ArtifactPack</text><!--MD5=[79529a643adf47bff4716adad7b5b25d]
link negotiation_agent to artifact_builder--><path d="M983.83,1459.3938 C971.73,1471.4838 957.96,1482.6438 943,1490.3438 C917.91,1503.2638 902.94,1481.8938 880,1498.3438 C823.05,1539.1838 846.1,1656.7638 862,1681.8438 C912.16,1760.9438 1020.28,1796.1738 1091.29,1811.2738 " fill="none" id="negotiation_agent-to-artifact_builder" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="1096.34,1812.3238,1088.341,1806.5778,1091.4444,1811.3074,1086.7148,1814.4108,1096.34,1812.3238" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="85" x="863" y="1625.2627">Build ArtifactPack</text><!--MD5=[c218177ccb6628251a4db4a73a8e60f8]
link contract_agent to artifact_builder--><path d="M782.21,1412.2438 C740.92,1428.6638 692.51,1455.8638 668,1498.3438 C630.82,1562.7738 639.33,1587.8638 749,1681.8438 C848.68,1767.2538 1003,1801.2838 1091.13,1814.2838 " fill="none" id="contract_agent-to-artifact_builder" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="1096.32,1815.0338,1087.9825,1809.7911,1091.3711,1814.3207,1086.8415,1817.7093,1096.32,1815.0338" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="85" x="750" y="1625.2627">Build ArtifactPack</text><!--MD5=[abe8e97fd0fdfb604b97a3c7f8007f3d]
link impl_agent to artifact_builder--><path d="M1791.91,1459.4138 C1802.15,1488.0438 1808.83,1517.0438 1799,1527.3438 C1785.95,1541.0238 1644.29,1524.2138 1629,1535.3438 C1572.78,1576.2838 1624,1633.5038 1574,1681.8438 C1477.69,1774.9538 1317.41,1806.2138 1226.8,1816.6538 " fill="none" id="impl_agent-to-artifact_builder" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="1221.74,1817.2238,1231.1295,1820.1965,1226.7089,1816.6669,1230.2385,1812.2463,1221.74,1817.2238" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="85" x="1630" y="1625.2627">Build ArtifactPack</text><!--MD5=[8418438e9197051364b81f2dfd8f71ff]
link signal_agent to exec_metadata--><path d="M1327.67,1466.6238 C1308.23,1486.8838 1286.73,1508.4038 1266,1527.3438 C1261.8,1531.1838 1260.37,1531.7038 1256,1535.3438 C1239.11,1549.4038 1220.84,1565.0938 1204.75,1579.0838 " fill="none" id="signal_agent-to-exec_metadata" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="1200.71,1582.6038,1210.1235,1579.7077,1204.48,1579.3193,1204.8684,1573.6758,1200.71,1582.6038" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="77" x="1297" y="1517.7627">Track execution</text><!--MD5=[8ec05112213d8a630edfe053e66999d9]
link supplier_agent to exec_metadata--><path d="M1538.9,1459.7138 C1515.66,1489.4538 1489.58,1519.3038 1473,1527.3438 C1429.58,1548.4038 1300.9,1517.6538 1256,1535.3438 C1232.49,1544.6038 1210.77,1562.1438 1193.87,1578.8138 " fill="none" id="supplier_agent-to-exec_metadata" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="1190.12,1582.5838,1199.3052,1579.0297,1193.6484,1579.0411,1193.637,1573.3842,1190.12,1582.5838" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="77" x="1505" y="1517.7627">Track execution</text><!--MD5=[699d83423aab89724b3349ad4a927386]
link rfx_agent to exec_metadata--><path d="M1169.4,1452.4638 C1156.95,1466.4338 1142.54,1480.1438 1127,1490.3438 C1117.25,1496.7438 1108.88,1488.9238 1102,1498.3438 C1084.08,1522.9038 1099.39,1553.9838 1118.64,1578.5038 " fill="none" id="rfx_agent-to-exec_metadata" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="1122.02,1582.6838,1119.4873,1573.1661,1118.8826,1578.7906,1113.2582,1578.1859,1122.02,1582.6838" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="77" x="1103" y="1517.7627">Track execution</text><!--MD5=[1926e273fc9461be6bae5781ebc90307]
link negotiation_agent to exec_metadata--><path d="M983.08,1459.4538 C971.13,1471.3838 957.6,1482.4638 943,1490.3438 C923.97,1500.6138 908.98,1481.8438 895,1498.3438 C886.67,1508.1738 886.11,1518.0138 895,1527.3438 C907.82,1540.7938 1044.75,1528.4438 1062,1535.3438 C1085.46,1544.7338 1107.17,1562.2938 1124.08,1578.9338 " fill="none" id="negotiation_agent-to-exec_metadata" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="1127.83,1582.6938,1124.313,1573.4942,1124.3016,1579.1511,1118.6448,1579.1397,1127.83,1582.6938" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="77" x="896" y="1517.7627">Track execution</text><!--MD5=[b29ea8b4fd529741db15abbc98a9a783]
link contract_agent to exec_metadata--><path d="M782.4,1416.6438 C720.36,1442.6938 646.57,1485.0138 688,1527.3438 C702.54,1542.1938 1042.61,1527.8738 1062,1535.3438 C1085.58,1544.4238 1107.31,1561.9438 1124.19,1578.6438 " fill="none" id="contract_agent-to-exec_metadata" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="1127.94,1582.4238,1124.4602,1573.2101,1124.426,1578.8669,1118.7692,1578.8326,1127.94,1582.4238" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="77" x="689" y="1517.7627">Track execution</text><!--MD5=[0dbe83fbee8aa1ccfc4128decd9f9248]
link impl_agent to exec_metadata--><path d="M1737.56,1459.6138 C1724.65,1485.5238 1705.97,1512.3238 1680,1527.3438 C1659.61,1539.1438 1278,1526.9038 1256,1535.3438 C1232.22,1544.4638 1210.33,1562.2038 1193.38,1579.0338 " fill="none" id="impl_agent-to-exec_metadata" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="1189.62,1582.8338,1198.7908,1579.2426,1193.134,1579.2769,1193.0998,1573.6201,1189.62,1582.8338" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="77" x="1713" y="1517.7627">Track execution</text><!--MD5=[9e6f65f499346533f1426e40386c1f68]
link artifact_builder to chat_svc--><path d="M1096.29,1812.7038 C973.11,1793.5338 705.87,1745.5838 641,1681.8438 C501.32,1544.5938 600.51,1364.0238 766,1259.3438 C863.09,1197.9338 1665.16,1156.4638 1912.6,1145.0338 " fill="none" id="artifact_builder-to-chat_svc" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="1917.63,1144.8038,1908.4567,1141.2189,1912.6352,1145.0321,1908.8221,1149.2106,1917.63,1144.8038" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="59" x="579" y="1510.7627">ArtifactPack</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="53" x="582" y="1524.5986">+ Metadata</text><!--MD5=[2e43cbb5939e5725847377c2f67dad19]
link exec_metadata to artifact_builder--><path d="M1159,1658.1138 C1159,1692.6038 1159,1744.1038 1159,1780.1038 " fill="none" id="exec_metadata-to-artifact_builder" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="1159,1785.3038,1163,1776.3038,1159,1780.3038,1155,1776.3038,1159,1785.3038" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="81" x="1160" y="1709.2627">Include metadata</text><!--MD5=[cf97f47b7db5c1e788ae146ec3199228]
link chat_svc to state_mgr--><path d="M1991.67,1089.1338 C1997.71,1061.7138 2009.2,1029.1038 2031,1007.3438 C2058.95,979.4437 2080.21,997.0338 2115,978.3438 C2126.02,972.4237 2137.12,965.0138 2147.38,957.4337 " fill="none" id="chat_svc-to-state_mgr" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="2151.42,954.4038,2141.82,956.6037,2147.42,957.4038,2146.62,963.0037,2151.42,954.4038" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="75" x="2032" y="1022.2627">Check approval</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="46" x="2046.5" y="1036.0986">required?</text><!--MD5=[69dedf3e993b39b77d59316a930488fc]
link state_mgr to chat_svc--><path d="M2179.2,954.5638 C2165.87,982.7938 2143.51,1020.4038 2112,1041.3438 C2096.17,1051.8638 2086.65,1040.1938 2070,1049.3438 C2053.6,1058.3538 2038.54,1071.6738 2025.81,1085.3238 " fill="none" id="state_mgr-to-chat_svc" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="2022.28,1089.1838,2031.306,1085.2427,2025.6547,1085.4944,2025.4031,1079.8432,2022.28,1089.1838" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="112" x="2147" y="1019.7627">Set waiting_for_human</text><text fill="#000000" font-family="sans-serif" font-size="15" font-weight="bold" lengthAdjust="spacing" textLength="29" x="2188.5" y="1037.751">true</text><!--MD5=[de7e775e680aa93fb3f9995b60856c10]
link state_mgr to sqlite--><path d="M2256.08,950.9137 C2277.95,961.2538 2303.05,971.6737 2327,978.3438 C2434.34,1008.2137 2465.47,993.2938 2576,1007.3438 C2790.07,1034.5538 3538,924.0438 3538,1139.8438 C3538,1139.8438 3538,1139.8438 3538,1823.8438 C3538,2036.0538 3499.53,2109.4738 3355,2264.8438 C3333.66,2287.7838 3324.12,2290.2938 3295,2301.8438 C3278.55,2308.3638 3271.11,2300.6438 3256,2309.8438 C3235.65,2322.2338 3217.94,2340.9538 3203.73,2359.5438 " fill="none" id="state_mgr-to-sqlite" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="3200.57,2363.7538,3209.17,2358.9538,3203.57,2359.7538,3202.77,2354.1538,3200.57,2363.7538" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="79" x="3539" y="1702.2627">Save case state</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="69" x="3544" y="1716.0986">(ONLY writer)</text><!--MD5=[387592a9ca6bc6293c3631b5b7d92b8e]
link artifact_builder to case_svc--><path d="M1221.63,1813.8338 C1384.9,1792.8338 1815.27,1736.5338 1878,1718.8438 C1934.07,1703.0338 1994.5,1676.4238 2038.76,1654.9838 " fill="none" id="artifact_builder-to-case_svc" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="2043.26,1652.7938,2033.4168,1653.1279,2038.7625,1654.9783,2036.912,1660.3239,2043.26,1652.7938" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="87" x="1955" y="1709.2627">Save ArtifactPack</text><!--MD5=[8ece7f81910c558db007f6fdd8614a0f]
link case_svc to sqlite--><path d="M2164.73,1624.8838 C2365.7,1637.1938 2999.75,1681.1538 3059,1748.8438 C3102.33,1798.3338 3076.83,1833.5338 3059,1896.8438 C3049.53,1930.4438 3027.47,1930.2438 3018,1963.8438 C3005.71,2007.4837 3009.12,2021.3938 3018,2065.8438 C3039.57,2173.7738 3094.61,2289.9138 3131.14,2359.0638 " fill="none" id="case_svc-to-sqlite" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="3133.52,2363.5538,3132.8471,2353.7279,3131.1819,2359.1341,3125.7757,2357.4689,3133.52,2363.5538" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="76" x="3032.5" y="2032.7627">Persist artifacts</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="103" x="3019" y="2046.5986">+ execution metadata</text><!--MD5=[8ece7f81910c558db007f6fdd8614a0f]
link case_svc to sqlite--><path d="M2164.75,1623.9938 C2331.92,1631.6538 2796.2,1655.4938 2945,1689.8438 C3056.48,1715.5738 3166,1707.4338 3166,1821.8438 C3166,1821.8438 3166,1821.8438 3166,2186.8438 C3166,2244.9838 3166,2311.2238 3166,2358.4338 " fill="none" id="case_svc-to-sqlite-1" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="3166,2363.5238,3170,2354.5238,3166,2358.5238,3162,2354.5238,3166,2363.5238" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="108" x="3167" y="2039.7627">Persist ChatMessages</text><!--MD5=[f96841440943ccfa736e628a52342689]
link chat_svc to conv_mgr--><path d="M2052.27,1183.9438 C2072.58,1197.8738 2091.29,1212.3438 2098,1222.3438 C2121.49,1257.3538 2130.92,1304.7638 2134.66,1340.0338 " fill="none" id="chat_svc-to-conv_mgr" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="2135.17,1345.1538,2138.2785,1335.8083,2134.6852,1340.1773,2130.3162,1336.584,2135.17,1345.1538" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="56" x="2125" y="1234.7627">Get context</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="78" x="2114" y="1248.5986">Save messages</text><!--MD5=[275641cc2b450cb6700da9f1306a5461]
link conv_mgr to case_svc--><path d="M2130.72,1434.3638 C2124.77,1475.5038 2115.92,1536.8238 2110.05,1577.4338 " fill="none" id="conv_mgr-to-case_svc" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="2109.28,1582.7738,2114.5227,1574.4362,2109.9931,1577.8249,2106.6045,1573.2953,2109.28,1582.7738" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="111" x="2121" y="1517.7627">Query/Save messages</text><!--MD5=[e176f8c830ee7164b0452616077be7c3]
link ingest_svc to doc_ingest--><path d="M2217.22,1160.4738 C2271.65,1178.6338 2348.69,1210.6938 2402,1259.3438 C2430.76,1285.5938 2451.83,1325.2938 2464.4,1353.8138 " fill="none" id="ingest_svc-to-doc_ingest" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="2466.49,1358.6438,2466.5843,1348.7953,2464.5032,1354.0555,2459.2431,1351.9743,2466.49,1358.6438" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="54" x="2391" y="1241.7627">Documents</text><!--MD5=[ad0ea54048dcacdd93f8cab8289cb31b]
link ingest_svc to data_ingest--><path d="M2173.7,1172.1338 C2206.77,1218.2738 2269.58,1305.9138 2304.33,1354.4138 " fill="none" id="ingest_svc-to-data_ingest" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="2307.4,1358.6938,2305.4142,1349.0472,2304.4898,1354.628,2298.909,1353.7035,2307.4,1358.6938" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="75" x="2230" y="1241.7627">Structured data</text><!--MD5=[ff3530129096d5d30530c227192a89ca]
link doc_ingest to vector_store--><path d="M2478,1421.1538 C2478,1464.9138 2478,1548.3338 2478,1619.3438 C2478,1619.3438 2478,1619.3438 2478,2035.8438 C2478,2075.4638 2491.16,2089.6338 2473,2124.8438 C2466.13,2138.1638 2454.85,2149.5138 2443.09,2158.6538 " fill="none" id="doc_ingest-to-vector_store" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="2439.09,2161.6638,2448.6862,2159.4473,2443.0848,2158.6569,2443.8752,2153.0555,2439.09,2161.6638" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="70" x="2479" y="1820.7627">Embed &amp; store</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="35" x="2496.5" y="1834.5986">chunks</text><!--MD5=[821ca48bacb5330347de1515fdfba385]
link data_ingest to sqlite--><path d="M2343.27,1421.2938 C2355.69,1444.2138 2375.96,1474.3238 2403,1490.3438 C2581.75,1596.2438 3329,1411.5838 3329,1619.3438 C3329,1619.3438 3329,1619.3438 3329,2186.8438 C3329,2207.1338 3262.38,2297.3138 3214.33,2359.7338 " fill="none" id="data_ingest-to-sqlite" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="3211.19,2363.8038,3219.8389,2359.0924,3214.231,2359.8348,3213.4886,2354.2269,3211.19,2363.8038" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="79" x="3330" y="1939.2627">Validate &amp; insert</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="38" x="3350.5" y="1953.0986">records</text><!--MD5=[3c1d0493cc36ce2cbe4bc53743a6725e]
link doc_ingest to files--><path d="M2497.43,1420.8738 C2514.63,1444.5438 2542.09,1475.8738 2575,1490.3438 C2601.87,1502.1538 2809.7,1496.7638 2839,1498.3438 C2944.94,1504.0638 3233.68,1467.1938 3315,1535.3438 C3569.05,1748.2538 3418.82,1941.4538 3426,2272.8438 C3426.28,2285.7338 3430.15,2289.6438 3426,2301.8438 C3414.92,2334.4138 3390.97,2365.0338 3370.29,2387.1237 " fill="none" id="doc_ingest-to-files" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="3366.74,2390.8638,3375.8364,2387.0881,3370.1815,2387.2366,3370.033,2381.5817,3366.74,2390.8638" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="63" x="3458" y="1946.2627">Store original</text><!--MD5=[8045d37b54a169d6cedb2683a81e19cc]
link task_llm to llm--><path d="M1732.77,2201.1638 C1552.94,2243.2038 1027.93,2365.9538 850.43,2407.4538 " fill="none" id="task_llm-to-llm" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="845.54,2408.5938,855.2106,2410.4593,850.411,2407.4653,853.405,2402.6657,845.54,2408.5938" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="67" x="1451.5" y="2285.2627">Narration only</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="146" x="1412" y="2299.0986">(after rules/retrieval/analytics)</text><!--MD5=[309b8d07722bd08f6b0ec7dd1a19f921]
link router to llm--><path d="M2048.36,702.1338 C1712.18,706.9938 665.99,727.6138 532,797.3438 C472.37,828.3738 438,848.6238 438,915.8438 C438,915.8438 438,915.8438 438,2186.8438 C438,2325.9438 630.52,2387.4838 731.21,2410.1638 " fill="none" id="router-to-llm" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="736.23,2411.2738,728.312,2405.4166,731.3491,2410.1891,726.5766,2413.2261,736.23,2411.2738" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="87" x="448.5" y="1618.2627">LLM Classification</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="106" x="439" y="1632.0986">(primary, JSON mode)</text><!--MD5=[ab65b1da1d35171d40c933fa0b490861]
link task_rules to GMN111--><path d="M1838.03,1651.3538 C1856.72,1663.0638 1879.54,1675.2338 1902,1681.8438 C1933.81,1691.2038 2017.91,1687.6838 2051,1689.8438 C2391.73,1712.1138 2491.81,1644.7238 2817,1748.8438 C2827.86,1752.3238 2838.78,1756.9438 2849.36,1762.1838 " fill="none" id="task_rules-GMN111" style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><!--MD5=[9e6fd0a3f423e0aa519248b87fd3ae3a]
link state_mgr to GMN114--><path d="M2233.41,879.1538 C2261.81,854.7238 2302.41,825.0738 2344.5,811.8438 C2430.32,784.8638 2528.45,819.6238 2599.17,856.2037 " fill="none" id="state_mgr-GMN114" style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><!--MD5=[411e2e62d003d0346bae11258fcb214e]
link GMN117 to artifact_builder--><path d="M2607.96,1748.6138 C2587.07,1734.9338 2564,1722.6738 2540.5,1715.3438 C2369.31,1661.9338 1912.07,1698.7838 1733.5,1715.3438 C1545.32,1732.7938 1326.87,1781.7538 1221.8,1807.1438 " fill="none" id="GMN117-artifact_builder" style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><!--MD5=[8b9cc03d0a75b54d0795c7b65c402606]
link conv_mgr to GMN120--><path d="M2159.73,1345.1538 C2182.66,1305.5338 2222.14,1250.2738 2274.5,1225.8438 C2326.86,1201.4138 2481.21,1203.5238 2534.5,1225.8438 C2581.5,1245.5238 2621.74,1286.2838 2650.3,1322.2338 " fill="none" id="conv_mgr-GMN120" style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><rect fill="#DDDDDD" height="235.375" rx="5" ry="5" style="stroke:#000000;stroke-width:1.0;" width="208" x="3396" y="2886.0703"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="30" x="3405" y="2904.4893">Color</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="95" x="3441" y="2904.4893">Component Type</text><rect fill="#FFEBEE" height="13.8359" style="stroke:none;stroke-width:1.0;" width="36" x="3402" y="2906.9063"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="0" x="3405" y="2918.3252"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="63" x="3441" y="2918.3252">Human Actor</text><rect fill="#E3F2FD" height="13.8359" style="stroke:none;stroke-width:1.0;" width="36" x="3402" y="2920.7422"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="0" x="3405" y="2932.1611"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="95" x="3441" y="2932.1611">Frontend (Streamlit)</text><rect fill="#E8F5E9" height="13.8359" style="stroke:none;stroke-width:1.0;" width="36" x="3402" y="2934.5781"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="0" x="3405" y="2945.9971"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="90" x="3441" y="2945.9971">Backend (FastAPI)</text><rect fill="#FFF3E0" height="13.8359" style="stroke:none;stroke-width:1.0;" width="36" x="3402" y="2948.4141"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="0" x="3405" y="2959.833"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="126" x="3441" y="2959.833">Supervisor (Orchestrator)</text><rect fill="#F3E5F5" height="13.8359" style="stroke:none;stroke-width:1.0;" width="36" x="3402" y="2962.25"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="0" x="3405" y="2973.6689"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="89" x="3441" y="2973.6689">Official Agents (7)</text><rect fill="#FFF9C4" height="13.8359" style="stroke:none;stroke-width:1.0;" width="36" x="3402" y="2976.0859"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="0" x="3405" y="2987.5049"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="104" x="3441" y="2987.5049">Task Execution Layer</text><rect fill="#ECEFF1" height="13.8359" style="stroke:none;stroke-width:1.0;" width="36" x="3402" y="2989.9219"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="0" x="3405" y="3001.3408"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="88" x="3441" y="3001.3408">Data / Persistence</text><rect fill="#E8E8E8" height="13.8359" style="stroke:none;stroke-width:1.0;" width="36" x="3402" y="3003.7578"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="0" x="3405" y="3015.1768"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="78" x="3441" y="3015.1768">External System</text><line style="stroke:#000000;stroke-width:1.0;" x1="3402" x2="3570" y1="2893.0703" y2="2893.0703"/><line style="stroke:#000000;stroke-width:1.0;" x1="3402" x2="3570" y1="2906.9063" y2="2906.9063"/><line style="stroke:#000000;stroke-width:1.0;" x1="3402" x2="3570" y1="2920.7422" y2="2920.7422"/><line style="stroke:#000000;stroke-width:1.0;" x1="3402" x2="3570" y1="2934.5781" y2="2934.5781"/><line style="stroke:#000000;stroke-width:1.0;" x1="3402" x2="3570" y1="2948.4141" y2="2948.4141"/><line style="stroke:#000000;stroke-width:1.0;" x1="3402" x2="3570" y1="2962.25" y2="2962.25"/><line style="stroke:#000000;stroke-width:1.0;" x1="3402" x2="3570" y1="2976.0859" y2="2976.0859"/><line style="stroke:#000000;stroke-width:1.0;" x1="3402" x2="3570" y1="2989.9219" y2="2989.9219"/><line style="stroke:#000000;stroke-width:1.0;" x1="3402" x2="3570" y1="3003.7578" y2="3003.7578"/><line style="stroke:#000000;stroke-width:1.0;" x1="3402" x2="3570" y1="3017.5938" y2="3017.5938"/><line style="stroke:#000000;stroke-width:1.0;" x1="3402" x2="3402" y1="2893.0703" y2="3017.5938"/><line style="stroke:#000000;stroke-width:1.0;" x1="3438" x2="3438" y1="2893.0703" y2="3017.5938"/><line style="stroke:#000000;stroke-width:1.0;" x1="3570" x2="3570" y1="2893.0703" y2="3017.5938"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="0" x="3405" y="3031.0127"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="126" x="3402" y="3044.8486">Key Governance Rules:</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="167" x="3402" y="3058.6846">1. Supervisor is ONLY state writer</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="194" x="3402" y="3072.5205">2. Rules → Retrieval → Analytics → LLM</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="176" x="3402" y="3086.3564">3. Hybrid classification (rules + LLM)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="196" x="3402" y="3100.1924">4. Stage advancement requires approval</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="177" x="3402" y="3114.0283">5. All artifacts tracked with metadata</text><!--MD5=[d3edd6f9ce1d03006ca85c5e2c870ba3]
@startuml Agentic_Sourcing_Architecture

' =============================================================================
' AGENTIC SOURCING COPILOT — SYSTEM ARCHITECTURE DIAGRAM
' =============================================================================
' 
' Purpose: Visual representation of the human-in-the-loop, multi-agent 
'          decision-support system for procurement sourcing.
'
' Version: January 2026 - Reflects current implementation with comprehensive data
'
' Key Features:
'   • LLM-First Intent Classification with Structured Output
'   • 7 Official Agents with Task Execution Hierarchy
'   • Artifact System with Execution Metadata
'   • Two-Level Intent Classification (UserGoal + WorkType)
'   • Supervisor-only State Changes
'   • Conversation Memory with Cost-Aware Context Management (optional)
'   • Aggressive Caching (500 entries, 80%+ hit rate expected)
'
' To render: Use PlantUML extension in VS Code/Cursor (Alt+D) or online at
'            http://www.plantuml.com/plantuml
' =============================================================================

title Agentic Sourcing Copilot - Enterprise Architecture\n//Human-in-the-Loop Multi-Agent Decision Support System//\n\n**Current Implementation** — LLM-First Classification & Artifact System

skinparam backgroundColor #FEFEFE
skinparam defaultFontSize 11
skinparam roundcorner 10
skinparam shadowing true

skinparam rectangle {
    BackgroundColor<<human>> #FFEBEE
    BorderColor<<human>> #C62828
    BorderThickness 2
    BackgroundColor<<frontend>> #E3F2FD
    BorderColor<<frontend>> #1976D2
    BorderThickness 2
    BackgroundColor<<backend>> #E8F5E9
    BorderColor<<backend>> #388E3C
    BorderThickness 2
    BackgroundColor<<supervisor>> #FFF3E0
    BorderColor<<supervisor>> #F57C00
    BorderThickness 3
    BackgroundColor<<agent>> #F3E5F5
    BorderColor<<agent>> #7B1FA2
    BorderThickness 2
    BackgroundColor<<task>> #FFF9C4
    BorderColor<<task>> #F9A825
    BorderThickness 2
    BackgroundColor<<data>> #ECEFF1
    BorderColor<<data>> #546E7A
    BorderThickness 2
    BackgroundColor<<external>> #E8E8E8
    BorderColor<<external>> #999999
    BorderThickness 2
}

' ============== EXTERNAL ACTORS ==============
rectangle "👤 **Procurement Officer**\n(Human Decision-Maker)" as human <<human>>

rectangle "🤖 **OpenAI GPT-4**\n(LLM Provider)" as llm <<external>>

' ============== FRONTEND CONTAINER ==============
package "**FRONTEND** - Streamlit UI" <<frontend>> {
    rectangle "📊 **Case Dashboard**\nCase list, metrics,\nfiltering, status view" as dashboard
    rectangle "💬 **Case Copilot**\nChat interface,\nartifact display,\naudit trail" as copilot
    rectangle "📁 **Knowledge Management**\nDocument upload,\ndata ingestion" as knowledge
    rectangle "🔌 **API Client**\nHTTP/REST communication\nor Direct imports" as api_client
}

' ============== BACKEND CONTAINER ==============
package "**BACKEND** - FastAPI Server" <<backend>> {
    
    rectangle "🌐 **REST API**\n/cases, /chat, /decisions,\n/ingest, /health" as api
    
    package "**Services Layer**" {
        rectangle "💬 **Chat Service**\nMessage processing,\nintent handling,\nresponse formatting\n+ Conversation memory\n+ Cost estimation" as chat_svc
        rectangle "💾 **Conversation Context\nManager**\nContext retrieval,\nmessage storage,\ncost-aware selection" as conv_mgr
        rectangle "📋 **Case Service**\nCase CRUD,\nartifact management,\nstate persistence" as case_svc
        rectangle "📥 **Ingestion Service**\nUpload orchestration,\nvalidation" as ingest_svc
    }
    
    package "**SUPERVISOR** - Central Orchestrator" <<supervisor>> {
        rectangle "🧠 **Intent Router**\nLLM-First Classification:\n• LLM with structured output (primary)\n• Aggressive caching (500 entries)\n• Rule fallback (errors only)\n• Two-level (UserGoal+WorkType)" as router
        rectangle "📊 **State Manager**\nDTP stage tracking,\nvalidation, transitions,\nONLY state writer" as state_mgr
        rectangle "📋 **Action Planner**\nAgent selection,\ntask planning" as planner
    }
    
    package "**7 OFFICIAL AGENTS**" <<agent>> {
        rectangle "📡 **Sourcing Signal**\n(DTP-01)\nSignal detection,\nurgency scoring\n- - - -\n**Inputs:**\nCase: trigger_source, status\nPerf: overall_score, trend\nSpend: variance_percent\nSLA: severity" as signal_agent
        rectangle "⭐ **Supplier Scoring**\n(DTP-02)\nEvaluation, ranking,\neligibility checks\n- - - -\n**Inputs:**\nPerf: quality_score, delivery\nRFP: eval_criteria\nMarket: benchmarks" as supplier_agent
        rectangle "📝 **RFx Draft**\n(DTP-03)\nRFI/RFP/RFQ assembly\n- - - -\n**Inputs:**\nDocs: proposals, quotes\nPolicy: eval_rubrics\nPast: comparisons" as rfx_agent
        rectangle "🤝 **Negotiation Support**\n(DTP-04)\nLeverage analysis,\ntargets, playbook\n- - - -\n**Inputs:**\nMarket: rates, trends\nHistory: relationship_score\nStrategy: batna_info" as negotiation_agent
        rectangle "📄 **Contract Support**\n(DTP-05)\nTerm extraction,\nvalidation, handoff\n- - - -\n**Inputs:**\nKB: contract_templates\nState: negotiated_terms\nPolicy: compliance_check" as contract_agent
        rectangle "🚀 **Implementation**\n(DTP-06)\nRollout planning,\nvalue capture\n- - - -\n**Inputs:**\nKB: rollout_guides\nContract: kpi_defs\nPlan: milestones" as impl_agent
    }
    
    package "**TASK EXECUTION LAYER**" <<task>> {
        rectangle "1️⃣ **Rules**\nDeterministic checks,\npolicy validation" as task_rules
        rectangle "2️⃣ **Retrieval**\nChromaDB + SQLite\nquery, grounding" as task_retrieval
        rectangle "3️⃣ **Analytics**\nScoring, normalization,\ncomparison, ranking" as task_analytics
        rectangle "4️⃣ **LLM**\nNarration, summaries\n(last resort only)" as task_llm
    }
    
    package "**ARTIFACT SYSTEM**" {
        rectangle "📦 **Artifact Builder**\nPack creation,\nverification status,\ngrounding references" as artifact_builder
        rectangle "📊 **Execution Metadata**\nTokens, costs,\ntask details,\nretrieval sources" as exec_metadata
    }
    
    package "**RAG LAYER**" {
        rectangle "🔍 **Retriever**\nSemantic search,\nmetadata filter" as retriever
        rectangle "📦 **Vector Store**\nChromaDB wrapper" as vector_store
    }
    
    package "**INGESTION LAYER**" {
        rectangle "📄 **Doc Ingest**\nPDF, DOCX, TXT\n→ chunks → embed" as doc_ingest
        rectangle "📊 **Data Ingest**\nCSV, Excel\n→ validate → store" as data_ingest
    }
}

' ============== DATA LAYER ==============
package "**DATA LAYER** - Persistence" <<data>> {
    rectangle "🗄️ **SQLite**\nData Lake\n• Cases\n• ArtifactPacks\n• ChatMessages\n• Execution Metadata\n• Suppliers, Spend, SLAs" as sqlite
    rectangle "🧲 **ChromaDB**\nVector Store\n• Document embeddings\n• Semantic search" as chromadb
    rectangle "📁 **Files**\nUploaded documents\nSynthetic test data" as files
}

' ============== FLOW ARROWS ==============

' Human Interaction
human - -> copilot : "Asks questions,\nApproves/Rejects"
copilot - -> human : "Recommendations,\nEvidence, Pending\nApproval"

human - -> dashboard : "Views cases,\nselects case"
human - -> knowledge : "Uploads documents\n& data files"

' Frontend to Backend
dashboard - -> api_client
copilot - -> api_client
knowledge - -> api_client
api_client - -> api : "REST API calls\nor Direct imports"

' API to Services
api - -> case_svc : "Case CRUD"
api - -> chat_svc : "Chat messages"
api - -> ingest_svc : "File uploads"

' Chat Service to Supervisor
chat_svc - -> router : "User message\n+ context"
router - -> state_mgr : "Validates\nDTP stage"
router - -> planner : "Two-level intent\n→ Action Plan"
planner - -> chat_svc : "Agent + Tasks"

' Supervisor to Agents
chat_svc - -> signal_agent : "DTP-01:\nSignal detection"
chat_svc - -> supplier_agent : "DTP-02:\nSupplier scoring"
chat_svc - -> rfx_agent : "DTP-03:\nRFx drafting"
chat_svc - -> negotiation_agent : "DTP-04:\nNegotiation support"
chat_svc - -> contract_agent : "DTP-05:\nContract extraction"
chat_svc - -> impl_agent : "DTP-06:\nImplementation planning"

' Agents execute Tasks (in order)
signal_agent - -> task_rules : "1. Rules"
supplier_agent - -> task_rules : "1. Rules"
rfx_agent - -> task_rules : "1. Rules"
negotiation_agent - -> task_rules : "1. Rules"
contract_agent - -> task_rules : "1. Rules"
impl_agent - -> task_rules : "1. Rules"

task_rules - -> task_retrieval : "2. Retrieval"
task_retrieval - -> task_analytics : "3. Analytics"
task_analytics - -> task_llm : "4. LLM\n(if needed)"

' Agents use RAG
task_retrieval - -> retriever : "Query documents"
retriever - -> vector_store : "Semantic search"
vector_store - -> chromadb : "Vector query"

' Agents query structured data
task_retrieval - -> sqlite : "Query structured data\n(Suppliers, Spend, SLAs)"

' Agents return ArtifactPacks
signal_agent - -> artifact_builder : "Build ArtifactPack"
supplier_agent - -> artifact_builder : "Build ArtifactPack"
rfx_agent - -> artifact_builder : "Build ArtifactPack"
negotiation_agent - -> artifact_builder : "Build ArtifactPack"
contract_agent - -> artifact_builder : "Build ArtifactPack"
impl_agent - -> artifact_builder : "Build ArtifactPack"

' Execution Metadata tracking
signal_agent - -> exec_metadata : "Track execution"
supplier_agent - -> exec_metadata : "Track execution"
rfx_agent - -> exec_metadata : "Track execution"
negotiation_agent - -> exec_metadata : "Track execution"
contract_agent - -> exec_metadata : "Track execution"
impl_agent - -> exec_metadata : "Track execution"

' Artifacts return to Chat Service
artifact_builder - -> chat_svc : "ArtifactPack\n+ Metadata"
exec_metadata - -> artifact_builder : "Include metadata"

' Human-in-the-Loop Checkpoint
chat_svc - -> state_mgr : "Check approval\nrequired?"
state_mgr - -> chat_svc : "Set waiting_for_human\n= true"

' State updates (ONLY Supervisor/State Manager)
state_mgr - -> sqlite : "Save case state\n(ONLY writer)"

' Artifact persistence
artifact_builder - -> case_svc : "Save ArtifactPack"
case_svc - -> sqlite : "Persist artifacts\n+ execution metadata"

' Conversation Memory (optional, if enabled)
chat_svc - -> conv_mgr : "Get context\nSave messages"
conv_mgr - -> case_svc : "Query/Save messages"
case_svc - -> sqlite : "Persist ChatMessages"

' Ingestion Flow
ingest_svc - -> doc_ingest : "Documents"
ingest_svc - -> data_ingest : "Structured data"
doc_ingest - -> vector_store : "Embed & store\nchunks"
data_ingest - -> sqlite : "Validate & insert\nrecords"
doc_ingest - -> files : "Store original"

' LLM Calls (only via task_llm)
task_llm - -> llm : "Narration only\n(after rules/retrieval/analytics)"

' Hybrid Classification LLM call
router - -> llm : "LLM Classification\n(primary, JSON mode)"

' ============== NOTES ==============
note right of router
    **LLM-First Intent Classification**
    ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
    1. LLM classification (primary path)
    2. Structured output (Pydantic schema)
    3. Aggressive caching (500 entries)
    4. Two-level: UserGoal + WorkType
    5. Context-aware (DTP stage, conversation history)
    6. Rule fallback (errors only)
    7. Few-shot examples in prompt
end note

note bottom of task_rules
    **Task Execution Hierarchy**
    ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
    All agents follow same order:
    1. Rules (deterministic)
    2. Retrieval (ground in data)
    3. Analytics (calculate)
    4. LLM (narrate only)
    ⚠️ Never skip steps
end note

note right of state_mgr
    **Supervisor Governance**
    ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
    • ONLY component that writes
      case state
    • Validates all transitions
    • Enforces human approval
    • Blocks invalid DTP jumps
    • Logs all changes
end note

note left of artifact_builder
    **Artifact System**
    ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
    • ArtifactPacks with multiple
      artifacts
    • Verification status (VERIFIED/
      PARTIAL/UNVERIFIED)
    • Grounding references
    • Execution metadata (tokens,
      costs, task details)
    • Full audit trail
end note

note right of conv_mgr
    **Conversation Memory**
    (Optional Feature)
    ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
    • Enabled via env var
    • Cost-aware context selection
    • Pre-execution cost estimation
    • Backward compatible (disabled
      by default)
    • Messages persist in database
end note

note top of human
    **Human-in-the-Loop**
    ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
    ✅ Approve → Advance stage
    ✏️ Edit → Modify & resubmit
    ❌ Reject → Stay at stage
    
    AI advises, Human decides
end note

note bottom of sqlite
    **DTP Stage Data Requirements**
    ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
    **DTP-01 Strategy**:
    • SupplierPerformance, SpendMetric
    • SLAEvent, Market Benchmarks
    
    **DTP-02 Planning**:
    • Evaluation criteria, RFP templates
    • Supplier longlist
    
    **DTP-03 Sourcing**:
    • Proposals, Evaluation rubrics
    • Comparison templates
    
    **DTP-04 Negotiation**:
    • Market rates, BATNA info
    • Alternative quotes
    
    **DTP-05 Contracting**:
    • Contract templates, Legal terms
    
    **DTP-06 Implementation**:
    • Migration guides, KPI defs
end note

' ============== LEGEND ==============
legend right
    |= Color |= Component Type |
    | <#FFEBEE> | Human Actor |
    | <#E3F2FD> | Frontend (Streamlit) |
    | <#E8F5E9> | Backend (FastAPI) |
    | <#FFF3E0> | Supervisor (Orchestrator) |
    | <#F3E5F5> | Official Agents (7) |
    | <#FFF9C4> | Task Execution Layer |
    | <#ECEFF1> | Data / Persistence |
    | <#E8E8E8> | External System |
    
    **Key Governance Rules:**
    1. Supervisor is ONLY state writer
    2. Rules → Retrieval → Analytics → LLM
    3. Hybrid classification (rules + LLM)
    4. Stage advancement requires approval
    5. All artifacts tracked with metadata
endlegend

@enduml

@startuml Agentic_Sourcing_Architecture


title Agentic Sourcing Copilot - Enterprise Architecture\n//Human-in-the-Loop Multi-Agent Decision Support System//\n\n**Current Implementation** — LLM-First Classification & Artifact System

skinparam backgroundColor #FEFEFE
skinparam defaultFontSize 11
skinparam roundcorner 10
skinparam shadowing true

skinparam rectangle {
    BackgroundColor<<human>> #FFEBEE
    BorderColor<<human>> #C62828
    BorderThickness 2
    BackgroundColor<<frontend>> #E3F2FD
    BorderColor<<frontend>> #1976D2
    BorderThickness 2
    BackgroundColor<<backend>> #E8F5E9
    BorderColor<<backend>> #388E3C
    BorderThickness 2
    BackgroundColor<<supervisor>> #FFF3E0
    BorderColor<<supervisor>> #F57C00
    BorderThickness 3
    BackgroundColor<<agent>> #F3E5F5
    BorderColor<<agent>> #7B1FA2
    BorderThickness 2
    BackgroundColor<<task>> #FFF9C4
    BorderColor<<task>> #F9A825
    BorderThickness 2
    BackgroundColor<<data>> #ECEFF1
    BorderColor<<data>> #546E7A
    BorderThickness 2
    BackgroundColor<<external>> #E8E8E8
    BorderColor<<external>> #999999
    BorderThickness 2
}

rectangle "👤 **Procurement Officer**\n(Human Decision-Maker)" as human <<human>>

rectangle "🤖 **OpenAI GPT-4**\n(LLM Provider)" as llm <<external>>

package "**FRONTEND** - Streamlit UI" <<frontend>> {
    rectangle "📊 **Case Dashboard**\nCase list, metrics,\nfiltering, status view" as dashboard
    rectangle "💬 **Case Copilot**\nChat interface,\nartifact display,\naudit trail" as copilot
    rectangle "📁 **Knowledge Management**\nDocument upload,\ndata ingestion" as knowledge
    rectangle "🔌 **API Client**\nHTTP/REST communication\nor Direct imports" as api_client
}

package "**BACKEND** - FastAPI Server" <<backend>> {
    
    rectangle "🌐 **REST API**\n/cases, /chat, /decisions,\n/ingest, /health" as api
    
    package "**Services Layer**" {
        rectangle "💬 **Chat Service**\nMessage processing,\nintent handling,\nresponse formatting\n+ Conversation memory\n+ Cost estimation" as chat_svc
        rectangle "💾 **Conversation Context\nManager**\nContext retrieval,\nmessage storage,\ncost-aware selection" as conv_mgr
        rectangle "📋 **Case Service**\nCase CRUD,\nartifact management,\nstate persistence" as case_svc
        rectangle "📥 **Ingestion Service**\nUpload orchestration,\nvalidation" as ingest_svc
    }
    
    package "**SUPERVISOR** - Central Orchestrator" <<supervisor>> {
        rectangle "🧠 **Intent Router**\nLLM-First Classification:\n• LLM with structured output (primary)\n• Aggressive caching (500 entries)\n• Rule fallback (errors only)\n• Two-level (UserGoal+WorkType)" as router
        rectangle "📊 **State Manager**\nDTP stage tracking,\nvalidation, transitions,\nONLY state writer" as state_mgr
        rectangle "📋 **Action Planner**\nAgent selection,\ntask planning" as planner
    }
    
    package "**7 OFFICIAL AGENTS**" <<agent>> {
        rectangle "📡 **Sourcing Signal**\n(DTP-01)\nSignal detection,\nurgency scoring\n- - - -\n**Inputs:**\nCase: trigger_source, status\nPerf: overall_score, trend\nSpend: variance_percent\nSLA: severity" as signal_agent
        rectangle "⭐ **Supplier Scoring**\n(DTP-02)\nEvaluation, ranking,\neligibility checks\n- - - -\n**Inputs:**\nPerf: quality_score, delivery\nRFP: eval_criteria\nMarket: benchmarks" as supplier_agent
        rectangle "📝 **RFx Draft**\n(DTP-03)\nRFI/RFP/RFQ assembly\n- - - -\n**Inputs:**\nDocs: proposals, quotes\nPolicy: eval_rubrics\nPast: comparisons" as rfx_agent
        rectangle "🤝 **Negotiation Support**\n(DTP-04)\nLeverage analysis,\ntargets, playbook\n- - - -\n**Inputs:**\nMarket: rates, trends\nHistory: relationship_score\nStrategy: batna_info" as negotiation_agent
        rectangle "📄 **Contract Support**\n(DTP-05)\nTerm extraction,\nvalidation, handoff\n- - - -\n**Inputs:**\nKB: contract_templates\nState: negotiated_terms\nPolicy: compliance_check" as contract_agent
        rectangle "🚀 **Implementation**\n(DTP-06)\nRollout planning,\nvalue capture\n- - - -\n**Inputs:**\nKB: rollout_guides\nContract: kpi_defs\nPlan: milestones" as impl_agent
    }
    
    package "**TASK EXECUTION LAYER**" <<task>> {
        rectangle "1️⃣ **Rules**\nDeterministic checks,\npolicy validation" as task_rules
        rectangle "2️⃣ **Retrieval**\nChromaDB + SQLite\nquery, grounding" as task_retrieval
        rectangle "3️⃣ **Analytics**\nScoring, normalization,\ncomparison, ranking" as task_analytics
        rectangle "4️⃣ **LLM**\nNarration, summaries\n(last resort only)" as task_llm
    }
    
    package "**ARTIFACT SYSTEM**" {
        rectangle "📦 **Artifact Builder**\nPack creation,\nverification status,\ngrounding references" as artifact_builder
        rectangle "📊 **Execution Metadata**\nTokens, costs,\ntask details,\nretrieval sources" as exec_metadata
    }
    
    package "**RAG LAYER**" {
        rectangle "🔍 **Retriever**\nSemantic search,\nmetadata filter" as retriever
        rectangle "📦 **Vector Store**\nChromaDB wrapper" as vector_store
    }
    
    package "**INGESTION LAYER**" {
        rectangle "📄 **Doc Ingest**\nPDF, DOCX, TXT\n→ chunks → embed" as doc_ingest
        rectangle "📊 **Data Ingest**\nCSV, Excel\n→ validate → store" as data_ingest
    }
}

package "**DATA LAYER** - Persistence" <<data>> {
    rectangle "🗄️ **SQLite**\nData Lake\n• Cases\n• ArtifactPacks\n• ChatMessages\n• Execution Metadata\n• Suppliers, Spend, SLAs" as sqlite
    rectangle "🧲 **ChromaDB**\nVector Store\n• Document embeddings\n• Semantic search" as chromadb
    rectangle "📁 **Files**\nUploaded documents\nSynthetic test data" as files
}


human - -> copilot : "Asks questions,\nApproves/Rejects"
copilot - -> human : "Recommendations,\nEvidence, Pending\nApproval"

human - -> dashboard : "Views cases,\nselects case"
human - -> knowledge : "Uploads documents\n& data files"

dashboard - -> api_client
copilot - -> api_client
knowledge - -> api_client
api_client - -> api : "REST API calls\nor Direct imports"

api - -> case_svc : "Case CRUD"
api - -> chat_svc : "Chat messages"
api - -> ingest_svc : "File uploads"

chat_svc - -> router : "User message\n+ context"
router - -> state_mgr : "Validates\nDTP stage"
router - -> planner : "Two-level intent\n→ Action Plan"
planner - -> chat_svc : "Agent + Tasks"

chat_svc - -> signal_agent : "DTP-01:\nSignal detection"
chat_svc - -> supplier_agent : "DTP-02:\nSupplier scoring"
chat_svc - -> rfx_agent : "DTP-03:\nRFx drafting"
chat_svc - -> negotiation_agent : "DTP-04:\nNegotiation support"
chat_svc - -> contract_agent : "DTP-05:\nContract extraction"
chat_svc - -> impl_agent : "DTP-06:\nImplementation planning"

signal_agent - -> task_rules : "1. Rules"
supplier_agent - -> task_rules : "1. Rules"
rfx_agent - -> task_rules : "1. Rules"
negotiation_agent - -> task_rules : "1. Rules"
contract_agent - -> task_rules : "1. Rules"
impl_agent - -> task_rules : "1. Rules"

task_rules - -> task_retrieval : "2. Retrieval"
task_retrieval - -> task_analytics : "3. Analytics"
task_analytics - -> task_llm : "4. LLM\n(if needed)"

task_retrieval - -> retriever : "Query documents"
retriever - -> vector_store : "Semantic search"
vector_store - -> chromadb : "Vector query"

task_retrieval - -> sqlite : "Query structured data\n(Suppliers, Spend, SLAs)"

signal_agent - -> artifact_builder : "Build ArtifactPack"
supplier_agent - -> artifact_builder : "Build ArtifactPack"
rfx_agent - -> artifact_builder : "Build ArtifactPack"
negotiation_agent - -> artifact_builder : "Build ArtifactPack"
contract_agent - -> artifact_builder : "Build ArtifactPack"
impl_agent - -> artifact_builder : "Build ArtifactPack"

signal_agent - -> exec_metadata : "Track execution"
supplier_agent - -> exec_metadata : "Track execution"
rfx_agent - -> exec_metadata : "Track execution"
negotiation_agent - -> exec_metadata : "Track execution"
contract_agent - -> exec_metadata : "Track execution"
impl_agent - -> exec_metadata : "Track execution"

artifact_builder - -> chat_svc : "ArtifactPack\n+ Metadata"
exec_metadata - -> artifact_builder : "Include metadata"

chat_svc - -> state_mgr : "Check approval\nrequired?"
state_mgr - -> chat_svc : "Set waiting_for_human\n= true"

state_mgr - -> sqlite : "Save case state\n(ONLY writer)"

artifact_builder - -> case_svc : "Save ArtifactPack"
case_svc - -> sqlite : "Persist artifacts\n+ execution metadata"

chat_svc - -> conv_mgr : "Get context\nSave messages"
conv_mgr - -> case_svc : "Query/Save messages"
case_svc - -> sqlite : "Persist ChatMessages"

ingest_svc - -> doc_ingest : "Documents"
ingest_svc - -> data_ingest : "Structured data"
doc_ingest - -> vector_store : "Embed & store\nchunks"
data_ingest - -> sqlite : "Validate & insert\nrecords"
doc_ingest - -> files : "Store original"

task_llm - -> llm : "Narration only\n(after rules/retrieval/analytics)"

router - -> llm : "LLM Classification\n(primary, JSON mode)"

note right of router
    **LLM-First Intent Classification**
    ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
    1. LLM classification (primary path)
    2. Structured output (Pydantic schema)
    3. Aggressive caching (500 entries)
    4. Two-level: UserGoal + WorkType
    5. Context-aware (DTP stage, conversation history)
    6. Rule fallback (errors only)
    7. Few-shot examples in prompt
end note

note bottom of task_rules
    **Task Execution Hierarchy**
    ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
    All agents follow same order:
    1. Rules (deterministic)
    2. Retrieval (ground in data)
    3. Analytics (calculate)
    4. LLM (narrate only)
    ⚠️ Never skip steps
end note

note right of state_mgr
    **Supervisor Governance**
    ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
    • ONLY component that writes
      case state
    • Validates all transitions
    • Enforces human approval
    • Blocks invalid DTP jumps
    • Logs all changes
end note

note left of artifact_builder
    **Artifact System**
    ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
    • ArtifactPacks with multiple
      artifacts
    • Verification status (VERIFIED/
      PARTIAL/UNVERIFIED)
    • Grounding references
    • Execution metadata (tokens,
      costs, task details)
    • Full audit trail
end note

note right of conv_mgr
    **Conversation Memory**
    (Optional Feature)
    ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
    • Enabled via env var
    • Cost-aware context selection
    • Pre-execution cost estimation
    • Backward compatible (disabled
      by default)
    • Messages persist in database
end note

note top of human
    **Human-in-the-Loop**
    ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
    ✅ Approve → Advance stage
    ✏️ Edit → Modify & resubmit
    ❌ Reject → Stay at stage
    
    AI advises, Human decides
end note

note bottom of sqlite
    **DTP Stage Data Requirements**
    ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
    **DTP-01 Strategy**:
    • SupplierPerformance, SpendMetric
    • SLAEvent, Market Benchmarks
    
    **DTP-02 Planning**:
    • Evaluation criteria, RFP templates
    • Supplier longlist
    
    **DTP-03 Sourcing**:
    • Proposals, Evaluation rubrics
    • Comparison templates
    
    **DTP-04 Negotiation**:
    • Market rates, BATNA info
    • Alternative quotes
    
    **DTP-05 Contracting**:
    • Contract templates, Legal terms
    
    **DTP-06 Implementation**:
    • Migration guides, KPI defs
end note

legend right
    |= Color |= Component Type |
    | <#FFEBEE> | Human Actor |
    | <#E3F2FD> | Frontend (Streamlit) |
    | <#E8F5E9> | Backend (FastAPI) |
    | <#FFF3E0> | Supervisor (Orchestrator) |
    | <#F3E5F5> | Official Agents (7) |
    | <#FFF9C4> | Task Execution Layer |
    | <#ECEFF1> | Data / Persistence |
    | <#E8E8E8> | External System |
    
    **Key Governance Rules:**
    1. Supervisor is ONLY state writer
    2. Rules → Retrieval → Analytics → LLM
    3. Hybrid classification (rules + LLM)
    4. Stage advancement requires approval
    5. All artifacts tracked with metadata
endlegend

@enduml

PlantUML version 1.2021.00(Sun Jan 10 05:25:05 EST 2021)
(MIT source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: Cp1252
Language: en
Country: US
--></g></svg>